ª$
LC:\Users\Norial\Documents\GitHub\food-ordering-system\FoodProject\Program.cs
var		 
builder		 
=		 
WebApplication		 
.		 
CreateBuilder		 *
(		* +
args		+ /
)		/ 0
;		0 1
builder 
. 
Services 
. #
AddControllersWithViews (
(( )
)) *
;* +
builder 
. 
WebHost 
. 
UseUrls 
( 
$str +
)+ ,
;, -
builder 
. 
Services 
. 
AddDbContext 
< 
MenuContext )
>) *
(* +
options+ 2
=>3 5
options 
. 
UseSqlServer 
( 
builder  
.  !
Configuration! .
.. /
GetConnectionString/ B
(B C
$strC \
)\ ]
)] ^
)^ _
;_ `
builder 
. 
Services 
. 

AddSession 
( 
options #
=>$ &
{ 
options 
. 
IdleTimeout 
= 
TimeSpan "
." #
FromMinutes# .
(. /
$num/ 1
)1 2
;2 3
options 
. 
Cookie 
. 
HttpOnly 
= 
true "
;" #
options 
. 
Cookie 
. 
IsEssential 
=  
true! %
;% &
} 
) 
; 
builder 
. 
Services 
. 
AddAuthentication "
(" #(
CookieAuthenticationDefaults# ?
.? @ 
AuthenticationScheme@ T
)T U
. 
	AddCookie 
( 
options 
=> 
{ 
options 
. 
	LoginPath 
= 
$str ,
;, -
options 
. 
Cookie 
. 
HttpOnly 
=  !
true" &
;& '
options   
.   
Cookie   
.   
IsEssential   "
=  # $
true  % )
;  ) *
}!! 
)!! 
;!! 
builder## 
.## 
Services## 
.## 
AddAuthorization## !
(##! "
)##" #
;### $
var$$ 
app$$ 
=$$ 	
builder$$
 
.$$ 
Build$$ 
($$ 
)$$ 
;$$ 
if'' 
('' 
!'' 
app'' 
.'' 	
Environment''	 
.'' 
IsDevelopment'' "
(''" #
)''# $
)''$ %
{(( 
app)) 
.)) 
UseExceptionHandler)) 
()) 
$str)) )
)))) *
;))* +
app++ 
.++ 
UseHsts++ 
(++ 
)++ 
;++ 
},, 
app.. 
... 
UseHttpsRedirection.. 
(.. 
).. 
;.. 
app// 
.// 
UseStaticFiles// 
(// 
)// 
;// 
app11 
.11 

UseRouting11 
(11 
)11 
;11 
app22 
.22 
UseHttpMetrics22 
(22 
)22 
;22 
app33 
.33 

UseSession33 
(33 
)33 
;33 
app44 
.44 
UseAuthentication44 
(44 
)44 
;44 
app55 
.55 
UseAuthorization55 
(55 
)55 
;55 
app66 
.66 
UseEndpoints66 
(66 
	endpoints66 
=>66 
{77 
	endpoints88 
.88 
MapControllers88 
(88 
)88 
;88 
	endpoints99 
.99 

MapMetrics99 
(99 
)99 
;99 
}:: 
):: 
;:: 
app<< 
.<< 
MapControllerRoute<< 
(<< 
name== 
:== 	
$str==
 
,== 
pattern>> 
:>> 
$str>> 5
)>>5 6
;>>6 7
app@@ 
.@@ 
Run@@ 
(@@ 
)@@ 	
;@@	 
›
SC:\Users\Norial\Documents\GitHub\food-ordering-system\FoodProject\Models\Voucher.cs
	namespace 	
FoodProject
 
. 
Models 
{ 
public 
class 
Voucher 
{ 
public 

int 
Id 
{ 
get 
; 
set 
; 
} 
public 

string 
Code 
{ 
get 
; 
set !
;! "
}# $
public 

double 
Discount 
{ 
get  
;  !
set" %
;% &
}' (
}		 
}

 ®
QC:\Users\Norial\Documents\GitHub\food-ordering-system\FoodProject\Models\Order.cs
	namespace 	
FoodProject
 
. 
Models 
{ 
public 

class 
Order 
{ 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
public		 
int		 
	AccountId		 
{		 
get		 "
;		" #
set		$ '
;		' (
}		) *
public

 
Account

 
Account

 
{

  
get

! $
;

$ %
set

& )
;

) *
}

+ ,
public 
double 

TotalPrice  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
List 
< 
	OrderItem 
> 

OrderItems )
{* +
get, /
;/ 0
set1 4
;4 5
}6 7
=8 9
new: =
List> B
<B C
	OrderItemC L
>L M
(M N
)N O
;O P
public 
string 
Status 
{ 
get "
;" #
set$ '
;' (
}) *
=+ ,
$str- 6
;6 7
public 
string 
? 
VoucherCode "
{# $
get% (
;( )
set* -
;- .
}/ 0
} 
public 

class 
	OrderItem 
{ 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
public 
int 
DishId 
{ 
get 
;  
set! $
;$ %
}& '
public 
Dish 
Dish 
{ 
get 
; 
set  #
;# $
}% &
public 
int 
Quantity 
{ 
get !
;! "
set# &
;& '
}( )
public 
double 
Price 
{ 
get !
;! "
set# &
;& '
}( )
} 
} µ
VC:\Users\Norial\Documents\GitHub\food-ordering-system\FoodProject\Models\Ingredient.cs
	namespace 	
FoodProject
 
. 
Models 
{ 
public 

class 

Ingredient 
{ 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
public 
string 
Name 
{ 
get  
;  !
set" %
;% &
}' (
public 
List 
< 
DishIngredient "
>" #
?# $
DishIngredients% 4
{5 6
get7 :
;: ;
set< ?
;? @
}A B
} 
}		 ë
]C:\Users\Norial\Documents\GitHub\food-ordering-system\FoodProject\Models\HomePageViewModel.cs
	namespace 	
FoodProject
 
. 
Models 
{ 
public 

class 
HomePageViewModel "
{ 
public 
List 
< 
Dish 
> 
Dishes  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
int 

TotalUsers 
{ 
get  #
;# $
set% (
;( )
}* +
}		 
}

 ∂
ZC:\Users\Norial\Documents\GitHub\food-ordering-system\FoodProject\Models\ErrorViewModel.cs
	namespace 	
FoodProject
 
. 
Models 
{ 
public 

class 
ErrorViewModel 
{ 
public 
string 
? 
	RequestId  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
bool 
ShowRequestId !
=>" $
!% &
string& ,
., -
IsNullOrEmpty- :
(: ;
	RequestId; D
)D E
;E F
} 
}		 î
ZC:\Users\Norial\Documents\GitHub\food-ordering-system\FoodProject\Models\DishIngredient.cs
	namespace 	
FoodProject
 
. 
Models 
{ 
public 

class 
DishIngredient 
{ 
public 
int 
DishId 
{ 
get 
;  
set! $
;$ %
}& '
public 
Dish 
Dish 
{ 
get 
; 
set  #
;# $
}% &
public 
int 
IngredientId 
{  !
get" %
;% &
set' *
;* +
}, -
public 

Ingredient 

Ingredient $
{% &
get' *
;* +
set, /
;/ 0
}1 2
}		 
}

 ì	
]C:\Users\Norial\Documents\GitHub\food-ordering-system\FoodProject\Models\DishEditViewModel.cs
	namespace 	
FoodProject
 
. 
Models 
{ 
public 

class 
DishEditViewModel "
{ 
public 
Dish 
Dish 
{ 
get 
; 
set  #
;# $
}% &
public 
List 
< 

Ingredient 
> 
AllIngredients  .
{/ 0
get1 4
;4 5
set6 9
;9 :
}; <
== >
new? B
ListC G
<G H

IngredientH R
>R S
(S T
)T U
;U V
public 
List 
< 
int 
> !
SelectedIngredientIds .
{/ 0
get1 4
;4 5
set6 9
;9 :
}; <
== >
new? B
ListC G
<G H
intH K
>K L
(L M
)M N
;N O
} 
}

 ÿ
PC:\Users\Norial\Documents\GitHub\food-ordering-system\FoodProject\Models\Dish.cs
	namespace 	
FoodProject
 
. 
Models 
{ 
public 

class 
Dish 
{ 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
public 
string 
Name 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
ImageUrl 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
? 
Description "
{# $
get% (
;( )
set* -
;- .
}/ 0
public		 
double		 
Price		 
{		 
get		 !
;		! "
set		# &
;		& '
}		( )
public

 
List

 
<

 
DishIngredient

 "
>

" #
?

# $
DishIngredients

% 4
{

5 6
get

7 :
;

: ;
set

< ?
;

? @
}

A B
public 
string 
Category 
{  
get! $
;$ %
set& )
;) *
}+ ,
=- .
$str/ 5
;5 6
} 
} ë

TC:\Users\Norial\Documents\GitHub\food-ordering-system\FoodProject\Models\CartItem.cs
	namespace 	
FoodProject
 
. 
Models 
{ 
public 

class 
CartItem 
{ 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
public 
int 
DishId 
{ 
get 
;  
set! $
;$ %
}& '
public		 
Dish		 
Dish		 
{		 
get		 
;		 
set		  #
;		# $
}		% &
public

 
int

 
Quantity

 
{

 
get

 !
;

! "
set

# &
;

& '
}

( )
public 
int 
	AccountId 
{ 
get "
;" #
set$ '
;' (
}) *
[ 	

ForeignKey	 
( 
$str 
)  
]  !
public 
Account 
Account 
{  
get! $
;$ %
set& )
;) *
}+ ,
} 
} Ë	
SC:\Users\Norial\Documents\GitHub\food-ordering-system\FoodProject\Models\Account.cs
	namespace 	
FoodProject
 
. 
Models 
{ 
public 

class 
Account 
{ 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
[ 	
Required	 
] 
public 
required 
string 
Username '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
[		 	
Required			 
]		 
[

 	
DataType

	 
(

 
DataType

 
.

 
Password

 #
)

# $
]

$ %
public 
required 
string 
Password '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
[ 	
Required	 
] 
public 
required 
string 
Role #
{$ %
get& )
;) *
set+ .
;. /
}0 1
} 
} è
kC:\Users\Norial\Documents\GitHub\food-ordering-system\FoodProject\Migrations\20250407153641_ordervoucher.cs
	namespace 	
FoodProject
 
. 

Migrations  
{ 
public 

partial 
class 
ordervoucher %
:& '
	Migration( 1
{		 
	protected 
override 
void 
Up  "
(" #
MigrationBuilder# 3
migrationBuilder4 D
)D E
{ 	
migrationBuilder 
. 
	AddColumn &
<& '
string' -
>- .
(. /
name 
: 
$str #
,# $
table 
: 
$str 
,  
type 
: 
$str %
,% &
nullable 
: 
true 
) 
;  
} 	
	protected 
override 
void 
Down  $
($ %
MigrationBuilder% 5
migrationBuilder6 F
)F G
{ 	
migrationBuilder 
. 

DropColumn '
(' (
name 
: 
$str #
,# $
table 
: 
$str 
)  
;  !
} 	
} 
} ê
fC:\Users\Norial\Documents\GitHub\food-ordering-system\FoodProject\Migrations\20250407113653_voucher.cs
	namespace 	
FoodProject
 
. 

Migrations  
{ 
public 

partial 
class 
voucher  
:! "
	Migration# ,
{		 
	protected 
override 
void 
Up  "
(" #
MigrationBuilder# 3
migrationBuilder4 D
)D E
{ 	
migrationBuilder 
. 
CreateTable (
(( )
name 
: 
$str  
,  !
columns 
: 
table 
=> !
new" %
{ 
Id 
= 
table 
. 
Column %
<% &
int& )
>) *
(* +
type+ /
:/ 0
$str1 6
,6 7
nullable8 @
:@ A
falseB G
)G H
. 

Annotation #
(# $
$str$ 8
,8 9
$str: @
)@ A
,A B
Code 
= 
table  
.  !
Column! '
<' (
string( .
>. /
(/ 0
type0 4
:4 5
$str6 E
,E F
nullableG O
:O P
falseQ V
)V W
,W X
Discount 
= 
table $
.$ %
Column% +
<+ ,
double, 2
>2 3
(3 4
type4 8
:8 9
$str: A
,A B
nullableC K
:K L
falseM R
)R S
} 
, 
constraints 
: 
table "
=># %
{ 
table 
. 

PrimaryKey $
($ %
$str% 2
,2 3
x4 5
=>6 8
x9 :
.: ;
Id; =
)= >
;> ?
} 
) 
; 
} 	
	protected 
override 
void 
Down  $
($ %
MigrationBuilder% 5
migrationBuilder6 F
)F G
{ 	
migrationBuilder 
. 
	DropTable &
(& '
name   
:   
$str    
)    !
;  ! "
}!! 	
}"" 
}## ‰
hC:\Users\Norial\Documents\GitHub\food-ordering-system\FoodProject\Migrations\20250319073503_orderUSer.cs
	namespace 	
FoodProject
 
. 

Migrations  
{ 
public 

partial 
class 
	orderUSer "
:# $
	Migration% .
{		 
	protected 
override 
void 
Up  "
(" #
MigrationBuilder# 3
migrationBuilder4 D
)D E
{ 	
migrationBuilder 
. 
	AddColumn &
<& '
int' *
>* +
(+ ,
name 
: 
$str !
,! "
table 
: 
$str 
,  
type 
: 
$str 
, 
nullable 
: 
false 
,  
defaultValue 
: 
$num 
)  
;  !
migrationBuilder 
. 
	AddColumn &
<& '
string' -
>- .
(. /
name 
: 
$str 
, 
table 
: 
$str 
,  
type 
: 
$str %
,% &
nullable 
: 
false 
,  
defaultValue 
: 
$str  
)  !
;! "
migrationBuilder 
. 
CreateIndex (
(( )
name 
: 
$str +
,+ ,
table 
: 
$str 
,  
column 
: 
$str #
)# $
;$ %
migrationBuilder   
.   
AddForeignKey   *
(  * +
name!! 
:!! 
$str!! 4
,!!4 5
table"" 
:"" 
$str"" 
,""  
column## 
:## 
$str## #
,### $
principalTable$$ 
:$$ 
$str$$  *
,$$* +
principalColumn%% 
:%%  
$str%%! %
,%%% &
onDelete&& 
:&& 
ReferentialAction&& +
.&&+ ,
Cascade&&, 3
)&&3 4
;&&4 5
}'' 	
	protected** 
override** 
void** 
Down**  $
(**$ %
MigrationBuilder**% 5
migrationBuilder**6 F
)**F G
{++ 	
migrationBuilder,, 
.,, 
DropForeignKey,, +
(,,+ ,
name-- 
:-- 
$str-- 4
,--4 5
table.. 
:.. 
$str.. 
)..  
;..  !
migrationBuilder00 
.00 
	DropIndex00 &
(00& '
name11 
:11 
$str11 +
,11+ ,
table22 
:22 
$str22 
)22  
;22  !
migrationBuilder44 
.44 

DropColumn44 '
(44' (
name55 
:55 
$str55 !
,55! "
table66 
:66 
$str66 
)66  
;66  !
migrationBuilder88 
.88 

DropColumn88 '
(88' (
name99 
:99 
$str99 
,99 
table:: 
::: 
$str:: 
)::  
;::  !
};; 	
}<< 
}== Ωø
bC:\Users\Norial\Documents\GitHub\food-ordering-system\FoodProject\Migrations\20250319072623_all.cs
	namespace 	
FoodProject
 
. 

Migrations  
{ 
public

 

partial

 
class

 
all

 
:

 
	Migration

 (
{ 
	protected 
override 
void 
Up  "
(" #
MigrationBuilder# 3
migrationBuilder4 D
)D E
{ 	
migrationBuilder 
. 
CreateTable (
(( )
name 
: 
$str  
,  !
columns 
: 
table 
=> !
new" %
{ 
Id 
= 
table 
. 
Column %
<% &
int& )
>) *
(* +
type+ /
:/ 0
$str1 6
,6 7
nullable8 @
:@ A
falseB G
)G H
. 

Annotation #
(# $
$str$ 8
,8 9
$str: @
)@ A
,A B
Username 
= 
table $
.$ %
Column% +
<+ ,
string, 2
>2 3
(3 4
type4 8
:8 9
$str: I
,I J
nullableK S
:S T
falseU Z
)Z [
,[ \
Password 
= 
table $
.$ %
Column% +
<+ ,
string, 2
>2 3
(3 4
type4 8
:8 9
$str: I
,I J
nullableK S
:S T
falseU Z
)Z [
,[ \
Role 
= 
table  
.  !
Column! '
<' (
string( .
>. /
(/ 0
type0 4
:4 5
$str6 E
,E F
nullableG O
:O P
falseQ V
)V W
} 
, 
constraints 
: 
table "
=># %
{ 
table 
. 

PrimaryKey $
($ %
$str% 2
,2 3
x4 5
=>6 8
x9 :
.: ;
Id; =
)= >
;> ?
} 
) 
; 
migrationBuilder 
. 
CreateTable (
(( )
name 
: 
$str 
, 
columns   
:   
table   
=>   !
new  " %
{!! 
Id"" 
="" 
table"" 
."" 
Column"" %
<""% &
int""& )
>"") *
(""* +
type""+ /
:""/ 0
$str""1 6
,""6 7
nullable""8 @
:""@ A
false""B G
)""G H
.## 

Annotation## #
(### $
$str##$ 8
,##8 9
$str##: @
)##@ A
,##A B
Name$$ 
=$$ 
table$$  
.$$  !
Column$$! '
<$$' (
string$$( .
>$$. /
($$/ 0
type$$0 4
:$$4 5
$str$$6 E
,$$E F
nullable$$G O
:$$O P
false$$Q V
)$$V W
,$$W X
ImageUrl%% 
=%% 
table%% $
.%%$ %
Column%%% +
<%%+ ,
string%%, 2
>%%2 3
(%%3 4
type%%4 8
:%%8 9
$str%%: I
,%%I J
nullable%%K S
:%%S T
false%%U Z
)%%Z [
,%%[ \
Description&& 
=&&  !
table&&" '
.&&' (
Column&&( .
<&&. /
string&&/ 5
>&&5 6
(&&6 7
type&&7 ;
:&&; <
$str&&= L
,&&L M
nullable&&N V
:&&V W
true&&X \
)&&\ ]
,&&] ^
Price'' 
='' 
table'' !
.''! "
Column''" (
<''( )
double'') /
>''/ 0
(''0 1
type''1 5
:''5 6
$str''7 >
,''> ?
nullable''@ H
:''H I
false''J O
)''O P
,''P Q
Category(( 
=(( 
table(( $
.(($ %
Column((% +
<((+ ,
string((, 2
>((2 3
(((3 4
type((4 8
:((8 9
$str((: I
,((I J
nullable((K S
:((S T
false((U Z
)((Z [
})) 
,)) 
constraints** 
:** 
table** "
=>**# %
{++ 
table,, 
.,, 

PrimaryKey,, $
(,,$ %
$str,,% 0
,,,0 1
x,,2 3
=>,,4 6
x,,7 8
.,,8 9
Id,,9 ;
),,; <
;,,< =
}-- 
)-- 
;-- 
migrationBuilder// 
.// 
CreateTable// (
(//( )
name00 
:00 
$str00 #
,00# $
columns11 
:11 
table11 
=>11 !
new11" %
{22 
Id33 
=33 
table33 
.33 
Column33 %
<33% &
int33& )
>33) *
(33* +
type33+ /
:33/ 0
$str331 6
,336 7
nullable338 @
:33@ A
false33B G
)33G H
.44 

Annotation44 #
(44# $
$str44$ 8
,448 9
$str44: @
)44@ A
,44A B
Name55 
=55 
table55  
.55  !
Column55! '
<55' (
string55( .
>55. /
(55/ 0
type550 4
:554 5
$str556 E
,55E F
nullable55G O
:55O P
false55Q V
)55V W
}66 
,66 
constraints77 
:77 
table77 "
=>77# %
{88 
table99 
.99 

PrimaryKey99 $
(99$ %
$str99% 5
,995 6
x997 8
=>999 ;
x99< =
.99= >
Id99> @
)99@ A
;99A B
}:: 
):: 
;:: 
migrationBuilder<< 
.<< 
CreateTable<< (
(<<( )
name== 
:== 
$str== 
,== 
columns>> 
:>> 
table>> 
=>>> !
new>>" %
{?? 
Id@@ 
=@@ 
table@@ 
.@@ 
Column@@ %
<@@% &
int@@& )
>@@) *
(@@* +
type@@+ /
:@@/ 0
$str@@1 6
,@@6 7
nullable@@8 @
:@@@ A
false@@B G
)@@G H
.AA 

AnnotationAA #
(AA# $
$strAA$ 8
,AA8 9
$strAA: @
)AA@ A
,AAA B

TotalPriceBB 
=BB  
tableBB! &
.BB& '
ColumnBB' -
<BB- .
doubleBB. 4
>BB4 5
(BB5 6
typeBB6 :
:BB: ;
$strBB< C
,BBC D
nullableBBE M
:BBM N
falseBBO T
)BBT U
}CC 
,CC 
constraintsDD 
:DD 
tableDD "
=>DD# %
{EE 
tableFF 
.FF 

PrimaryKeyFF $
(FF$ %
$strFF% 0
,FF0 1
xFF2 3
=>FF4 6
xFF7 8
.FF8 9
IdFF9 ;
)FF; <
;FF< =
}GG 
)GG 
;GG 
migrationBuilderII 
.II 
CreateTableII (
(II( )
nameJJ 
:JJ 
$strJJ !
,JJ! "
columnsKK 
:KK 
tableKK 
=>KK !
newKK" %
{LL 
IdMM 
=MM 
tableMM 
.MM 
ColumnMM %
<MM% &
intMM& )
>MM) *
(MM* +
typeMM+ /
:MM/ 0
$strMM1 6
,MM6 7
nullableMM8 @
:MM@ A
falseMMB G
)MMG H
.NN 

AnnotationNN #
(NN# $
$strNN$ 8
,NN8 9
$strNN: @
)NN@ A
,NNA B
DishIdOO 
=OO 
tableOO "
.OO" #
ColumnOO# )
<OO) *
intOO* -
>OO- .
(OO. /
typeOO/ 3
:OO3 4
$strOO5 :
,OO: ;
nullableOO< D
:OOD E
falseOOF K
)OOK L
,OOL M
QuantityPP 
=PP 
tablePP $
.PP$ %
ColumnPP% +
<PP+ ,
intPP, /
>PP/ 0
(PP0 1
typePP1 5
:PP5 6
$strPP7 <
,PP< =
nullablePP> F
:PPF G
falsePPH M
)PPM N
,PPN O
	AccountIdQQ 
=QQ 
tableQQ  %
.QQ% &
ColumnQQ& ,
<QQ, -
intQQ- 0
>QQ0 1
(QQ1 2
typeQQ2 6
:QQ6 7
$strQQ8 =
,QQ= >
nullableQQ? G
:QQG H
falseQQI N
)QQN O
}RR 
,RR 
constraintsSS 
:SS 
tableSS "
=>SS# %
{TT 
tableUU 
.UU 

PrimaryKeyUU $
(UU$ %
$strUU% 3
,UU3 4
xUU5 6
=>UU7 9
xUU: ;
.UU; <
IdUU< >
)UU> ?
;UU? @
tableVV 
.VV 

ForeignKeyVV $
(VV$ %
nameWW 
:WW 
$strWW ?
,WW? @
columnXX 
:XX 
xXX  !
=>XX" $
xXX% &
.XX& '
	AccountIdXX' 0
,XX0 1
principalTableYY &
:YY& '
$strYY( 2
,YY2 3
principalColumnZZ '
:ZZ' (
$strZZ) -
,ZZ- .
onDelete[[  
:[[  !
ReferentialAction[[" 3
.[[3 4
Cascade[[4 ;
)[[; <
;[[< =
table\\ 
.\\ 

ForeignKey\\ $
(\\$ %
name]] 
:]] 
$str]] :
,]]: ;
column^^ 
:^^ 
x^^  !
=>^^" $
x^^% &
.^^& '
DishId^^' -
,^^- .
principalTable__ &
:__& '
$str__( 0
,__0 1
principalColumn`` '
:``' (
$str``) -
,``- .
onDeleteaa  
:aa  !
ReferentialActionaa" 3
.aa3 4
Cascadeaa4 ;
)aa; <
;aa< =
}bb 
)bb 
;bb 
migrationBuilderdd 
.dd 
CreateTabledd (
(dd( )
nameee 
:ee 
$stree '
,ee' (
columnsff 
:ff 
tableff 
=>ff !
newff" %
{gg 
DishIdhh 
=hh 
tablehh "
.hh" #
Columnhh# )
<hh) *
inthh* -
>hh- .
(hh. /
typehh/ 3
:hh3 4
$strhh5 :
,hh: ;
nullablehh< D
:hhD E
falsehhF K
)hhK L
,hhL M
IngredientIdii  
=ii! "
tableii# (
.ii( )
Columnii) /
<ii/ 0
intii0 3
>ii3 4
(ii4 5
typeii5 9
:ii9 :
$strii; @
,ii@ A
nullableiiB J
:iiJ K
falseiiL Q
)iiQ R
}jj 
,jj 
constraintskk 
:kk 
tablekk "
=>kk# %
{ll 
tablemm 
.mm 

PrimaryKeymm $
(mm$ %
$strmm% 9
,mm9 :
xmm; <
=>mm= ?
newmm@ C
{mmD E
xmmF G
.mmG H
DishIdmmH N
,mmN O
xmmP Q
.mmQ R
IngredientIdmmR ^
}mm_ `
)mm` a
;mma b
tablenn 
.nn 

ForeignKeynn $
(nn$ %
nameoo 
:oo 
$stroo @
,oo@ A
columnpp 
:pp 
xpp  !
=>pp" $
xpp% &
.pp& '
DishIdpp' -
,pp- .
principalTableqq &
:qq& '
$strqq( 0
,qq0 1
principalColumnrr '
:rr' (
$strrr) -
,rr- .
onDeletess  
:ss  !
ReferentialActionss" 3
.ss3 4
Cascadess4 ;
)ss; <
;ss< =
tablett 
.tt 

ForeignKeytt $
(tt$ %
nameuu 
:uu 
$struu K
,uuK L
columnvv 
:vv 
xvv  !
=>vv" $
xvv% &
.vv& '
IngredientIdvv' 3
,vv3 4
principalTableww &
:ww& '
$strww( 5
,ww5 6
principalColumnxx '
:xx' (
$strxx) -
,xx- .
onDeleteyy  
:yy  !
ReferentialActionyy" 3
.yy3 4
Cascadeyy4 ;
)yy; <
;yy< =
}zz 
)zz 
;zz 
migrationBuilder|| 
.|| 
CreateTable|| (
(||( )
name}} 
:}} 
$str}} "
,}}" #
columns~~ 
:~~ 
table~~ 
=>~~ !
new~~" %
{ 
Id
ÄÄ 
=
ÄÄ 
table
ÄÄ 
.
ÄÄ 
Column
ÄÄ %
<
ÄÄ% &
int
ÄÄ& )
>
ÄÄ) *
(
ÄÄ* +
type
ÄÄ+ /
:
ÄÄ/ 0
$str
ÄÄ1 6
,
ÄÄ6 7
nullable
ÄÄ8 @
:
ÄÄ@ A
false
ÄÄB G
)
ÄÄG H
.
ÅÅ 

Annotation
ÅÅ #
(
ÅÅ# $
$str
ÅÅ$ 8
,
ÅÅ8 9
$str
ÅÅ: @
)
ÅÅ@ A
,
ÅÅA B
DishId
ÇÇ 
=
ÇÇ 
table
ÇÇ "
.
ÇÇ" #
Column
ÇÇ# )
<
ÇÇ) *
int
ÇÇ* -
>
ÇÇ- .
(
ÇÇ. /
type
ÇÇ/ 3
:
ÇÇ3 4
$str
ÇÇ5 :
,
ÇÇ: ;
nullable
ÇÇ< D
:
ÇÇD E
false
ÇÇF K
)
ÇÇK L
,
ÇÇL M
Quantity
ÉÉ 
=
ÉÉ 
table
ÉÉ $
.
ÉÉ$ %
Column
ÉÉ% +
<
ÉÉ+ ,
int
ÉÉ, /
>
ÉÉ/ 0
(
ÉÉ0 1
type
ÉÉ1 5
:
ÉÉ5 6
$str
ÉÉ7 <
,
ÉÉ< =
nullable
ÉÉ> F
:
ÉÉF G
false
ÉÉH M
)
ÉÉM N
,
ÉÉN O
Price
ÑÑ 
=
ÑÑ 
table
ÑÑ !
.
ÑÑ! "
Column
ÑÑ" (
<
ÑÑ( )
double
ÑÑ) /
>
ÑÑ/ 0
(
ÑÑ0 1
type
ÑÑ1 5
:
ÑÑ5 6
$str
ÑÑ7 >
,
ÑÑ> ?
nullable
ÑÑ@ H
:
ÑÑH I
false
ÑÑJ O
)
ÑÑO P
,
ÑÑP Q
OrderId
ÖÖ 
=
ÖÖ 
table
ÖÖ #
.
ÖÖ# $
Column
ÖÖ$ *
<
ÖÖ* +
int
ÖÖ+ .
>
ÖÖ. /
(
ÖÖ/ 0
type
ÖÖ0 4
:
ÖÖ4 5
$str
ÖÖ6 ;
,
ÖÖ; <
nullable
ÖÖ= E
:
ÖÖE F
true
ÖÖG K
)
ÖÖK L
}
ÜÜ 
,
ÜÜ 
constraints
áá 
:
áá 
table
áá "
=>
áá# %
{
àà 
table
ââ 
.
ââ 

PrimaryKey
ââ $
(
ââ$ %
$str
ââ% 4
,
ââ4 5
x
ââ6 7
=>
ââ8 :
x
ââ; <
.
ââ< =
Id
ââ= ?
)
ââ? @
;
ââ@ A
table
ää 
.
ää 

ForeignKey
ää $
(
ää$ %
name
ãã 
:
ãã 
$str
ãã ;
,
ãã; <
column
åå 
:
åå 
x
åå  !
=>
åå" $
x
åå% &
.
åå& '
DishId
åå' -
,
åå- .
principalTable
çç &
:
çç& '
$str
çç( 0
,
çç0 1
principalColumn
éé '
:
éé' (
$str
éé) -
,
éé- .
onDelete
èè  
:
èè  !
ReferentialAction
èè" 3
.
èè3 4
Cascade
èè4 ;
)
èè; <
;
èè< =
table
êê 
.
êê 

ForeignKey
êê $
(
êê$ %
name
ëë 
:
ëë 
$str
ëë <
,
ëë< =
column
íí 
:
íí 
x
íí  !
=>
íí" $
x
íí% &
.
íí& '
OrderId
íí' .
,
íí. /
principalTable
ìì &
:
ìì& '
$str
ìì( 0
,
ìì0 1
principalColumn
îî '
:
îî' (
$str
îî) -
)
îî- .
;
îî. /
}
ïï 
)
ïï 
;
ïï 
migrationBuilder
óó 
.
óó 

InsertData
óó '
(
óó' (
table
òò 
:
òò 
$str
òò 
,
òò  
columns
ôô 
:
ôô 
new
ôô 
[
ôô 
]
ôô 
{
ôô  
$str
ôô! %
,
ôô% &
$str
ôô' 1
,
ôô1 2
$str
ôô3 @
,
ôô@ A
$str
ôôB L
,
ôôL M
$str
ôôN T
,
ôôT U
$str
ôôV ]
}
ôô^ _
,
ôô_ `
values
öö 
:
öö 
new
öö 
object
öö "
[
öö" #
,
öö# $
]
öö$ %
{
õõ 
{
úú 
$num
úú 
,
úú 
$str
úú 
,
úú  
null
úú! %
,
úú% &
$str
úú' ~
,
úú~ 
$strúúÄ á
,úúá à
$numúúâ õ
}úúú ù
,úúù û
{
ùù 
$num
ùù 
,
ùù 
$str
ùù 
,
ùù  
null
ùù! %
,
ùù% &
$str
ùù' t
,
ùùt u
$str
ùùv ~
,
ùù~ 
$numùùÄ í
}ùùì î
,ùùî ï
{
ûû 
$num
ûû 
,
ûû 
$str
ûû 
,
ûû  
null
ûû! %
,
ûû% &
$strûû' ë
,ûûë í
$strûûì ù
,ûûù û
$numûûü ±
}ûû≤ ≥
}
üü 
)
üü 
;
üü 
migrationBuilder
°° 
.
°° 

InsertData
°° '
(
°°' (
table
¢¢ 
:
¢¢ 
$str
¢¢ $
,
¢¢$ %
columns
££ 
:
££ 
new
££ 
[
££ 
]
££ 
{
££  
$str
££! %
,
££% &
$str
££' -
}
££. /
,
££/ 0
values
§§ 
:
§§ 
new
§§ 
object
§§ "
[
§§" #
,
§§# $
]
§§$ %
{
•• 
{
¶¶ 
$num
¶¶ 
,
¶¶ 
$str
¶¶ !
}
¶¶" #
,
¶¶# $
{
ßß 
$num
ßß 
,
ßß 
$str
ßß !
}
ßß" #
,
ßß# $
{
®® 
$num
®® 
,
®® 
$str
®®  
}
®®! "
,
®®" #
{
©© 
$num
©© 
,
©© 
$str
©© 
}
©©  !
,
©©! "
{
™™ 
$num
™™ 
,
™™ 
$str
™™ '
}
™™( )
,
™™) *
{
´´ 
$num
´´ 
,
´´ 
$str
´´ #
}
´´$ %
}
¨¨ 
)
¨¨ 
;
¨¨ 
migrationBuilder
ÆÆ 
.
ÆÆ 

InsertData
ÆÆ '
(
ÆÆ' (
table
ØØ 
:
ØØ 
$str
ØØ (
,
ØØ( )
columns
∞∞ 
:
∞∞ 
new
∞∞ 
[
∞∞ 
]
∞∞ 
{
∞∞  
$str
∞∞! )
,
∞∞) *
$str
∞∞+ 9
}
∞∞: ;
,
∞∞; <
values
±± 
:
±± 
new
±± 
object
±± "
[
±±" #
,
±±# $
]
±±$ %
{
≤≤ 
{
≥≥ 
$num
≥≥ 
,
≥≥ 
$num
≥≥ 
}
≥≥ 
,
≥≥ 
{
¥¥ 
$num
¥¥ 
,
¥¥ 
$num
¥¥ 
}
¥¥ 
,
¥¥ 
{
µµ 
$num
µµ 
,
µµ 
$num
µµ 
}
µµ 
,
µµ 
{
∂∂ 
$num
∂∂ 
,
∂∂ 
$num
∂∂ 
}
∂∂ 
,
∂∂ 
{
∑∑ 
$num
∑∑ 
,
∑∑ 
$num
∑∑ 
}
∑∑ 
,
∑∑ 
{
∏∏ 
$num
∏∏ 
,
∏∏ 
$num
∏∏ 
}
∏∏ 
,
∏∏ 
{
ππ 
$num
ππ 
,
ππ 
$num
ππ 
}
ππ 
,
ππ 
{
∫∫ 
$num
∫∫ 
,
∫∫ 
$num
∫∫ 
}
∫∫ 
,
∫∫ 
{
ªª 
$num
ªª 
,
ªª 
$num
ªª 
}
ªª 
,
ªª 
{
ºº 
$num
ºº 
,
ºº 
$num
ºº 
}
ºº 
,
ºº 
{
ΩΩ 
$num
ΩΩ 
,
ΩΩ 
$num
ΩΩ 
}
ΩΩ 
}
ææ 
)
ææ 
;
ææ 
migrationBuilder
¿¿ 
.
¿¿ 
CreateIndex
¿¿ (
(
¿¿( )
name
¡¡ 
:
¡¡ 
$str
¡¡ .
,
¡¡. /
table
¬¬ 
:
¬¬ 
$str
¬¬ "
,
¬¬" #
column
√√ 
:
√√ 
$str
√√ #
)
√√# $
;
√√$ %
migrationBuilder
≈≈ 
.
≈≈ 
CreateIndex
≈≈ (
(
≈≈( )
name
∆∆ 
:
∆∆ 
$str
∆∆ +
,
∆∆+ ,
table
«« 
:
«« 
$str
«« "
,
««" #
column
»» 
:
»» 
$str
»»  
)
»»  !
;
»»! "
migrationBuilder
   
.
   
CreateIndex
   (
(
  ( )
name
ÀÀ 
:
ÀÀ 
$str
ÀÀ 7
,
ÀÀ7 8
table
ÃÃ 
:
ÃÃ 
$str
ÃÃ (
,
ÃÃ( )
column
ÕÕ 
:
ÕÕ 
$str
ÕÕ &
)
ÕÕ& '
;
ÕÕ' (
migrationBuilder
œœ 
.
œœ 
CreateIndex
œœ (
(
œœ( )
name
–– 
:
–– 
$str
–– ,
,
––, -
table
—— 
:
—— 
$str
—— #
,
——# $
column
““ 
:
““ 
$str
““  
)
““  !
;
““! "
migrationBuilder
‘‘ 
.
‘‘ 
CreateIndex
‘‘ (
(
‘‘( )
name
’’ 
:
’’ 
$str
’’ -
,
’’- .
table
÷÷ 
:
÷÷ 
$str
÷÷ #
,
÷÷# $
column
◊◊ 
:
◊◊ 
$str
◊◊ !
)
◊◊! "
;
◊◊" #
}
ÿÿ 	
	protected
€€ 
override
€€ 
void
€€ 
Down
€€  $
(
€€$ %
MigrationBuilder
€€% 5
migrationBuilder
€€6 F
)
€€F G
{
‹‹ 	
migrationBuilder
›› 
.
›› 
	DropTable
›› &
(
››& '
name
ﬁﬁ 
:
ﬁﬁ 
$str
ﬁﬁ !
)
ﬁﬁ! "
;
ﬁﬁ" #
migrationBuilder
‡‡ 
.
‡‡ 
	DropTable
‡‡ &
(
‡‡& '
name
·· 
:
·· 
$str
·· '
)
··' (
;
··( )
migrationBuilder
„„ 
.
„„ 
	DropTable
„„ &
(
„„& '
name
‰‰ 
:
‰‰ 
$str
‰‰ "
)
‰‰" #
;
‰‰# $
migrationBuilder
ÊÊ 
.
ÊÊ 
	DropTable
ÊÊ &
(
ÊÊ& '
name
ÁÁ 
:
ÁÁ 
$str
ÁÁ  
)
ÁÁ  !
;
ÁÁ! "
migrationBuilder
ÈÈ 
.
ÈÈ 
	DropTable
ÈÈ &
(
ÈÈ& '
name
ÍÍ 
:
ÍÍ 
$str
ÍÍ #
)
ÍÍ# $
;
ÍÍ$ %
migrationBuilder
ÏÏ 
.
ÏÏ 
	DropTable
ÏÏ &
(
ÏÏ& '
name
ÌÌ 
:
ÌÌ 
$str
ÌÌ 
)
ÌÌ 
;
ÌÌ  
migrationBuilder
ÔÔ 
.
ÔÔ 
	DropTable
ÔÔ &
(
ÔÔ& '
name
 
:
 
$str
 
)
 
;
  
}
ÒÒ 	
}
ÚÚ 
}ÛÛ «L
UC:\Users\Norial\Documents\GitHub\food-ordering-system\FoodProject\Data\MenuContext.cs
	namespace 	
FoodProject
 
. 
Data 
{ 
public 

class 
MenuContext 
: 
	DbContext (
{ 
public 
MenuContext 
( 
DbContextOptions +
<+ ,
MenuContext, 7
>7 8
options9 @
)@ A
:B C
baseD H
(H I
optionsI P
)P Q
{ 	
}

 	
	protected 
override 
void 
OnModelCreating  /
(/ 0
ModelBuilder0 <
modelBuilder= I
)I J
{ 	
modelBuilder 
. 
Entity 
<  
DishIngredient  .
>. /
(/ 0
)0 1
.1 2
HasKey2 8
(8 9
di9 ;
=>< >
new? B
{ 
di 
. 
DishId 
, 
di 
. 
IngredientId 
} 
) 
; 
modelBuilder 
. 
Entity 
<  
DishIngredient  .
>. /
(/ 0
)0 1
. 
HasOne 
( 
d 
=> 
d 
. 
Dish #
)# $
. 
WithMany 
( 
di 
=> 
di  "
." #
DishIngredients# 2
)2 3
. 
HasForeignKey 
( 
di !
=>" $
di% '
.' (
DishId( .
). /
;/ 0
modelBuilder 
. 
Entity 
<  
DishIngredient  .
>. /
(/ 0
)0 1
. 
HasOne 
( 
i 
=> 
i 
. 

Ingredient )
)) *
. 
WithMany 
( 
di 
=> 
di  "
." #
DishIngredients# 2
)2 3
. 
HasForeignKey 
( 
i  
=>! #
i$ %
.% &
IngredientId& 2
)2 3
;3 4
modelBuilder 
. 
Entity 
<  
Dish  $
>$ %
(% &
)& '
.' (
HasData( /
(/ 0
new 
Dish 
{ 
Id 
= 
$num 
, 
Name 
= 
$str "
," #
Price   
=   
$num    
,    !
ImageUrl!! 
=!! 
$str!! v
}"" 
,"" 
new## 
Dish## 
{$$ 
Id%% 
=%% 
$num%% 
,%% 
Name&& 
=&& 
$str&& #
,&&# $
Price'' 
='' 
$num''  
,''  !
ImageUrl(( 
=(( 
$str(( l
})) 
,)) 
new** 
Dish** 
{++ 
Id,, 
=,, 
$num,, 
,,, 
Name-- 
=-- 
$str-- %
,--% &
Price.. 
=.. 
$num..  
,..  !
ImageUrl// 
=// 
$str	// â
}00 
)11 
;11 
modelBuilder33 
.33 
Entity33 
<33  

Ingredient33  *
>33* +
(33+ ,
)33, -
.33- .
HasData33. 5
(335 6
new44 

Ingredient44 
{55 
Id66 
=66 
$num66 
,66 
Name77 
=77 
$str77 #
}88 
,88 
new99 

Ingredient99 
{:: 
Id;; 
=;; 
$num;; 
,;; 
Name<< 
=<< 
$str<< #
}== 
,== 
new>> 

Ingredient>> 
{?? 
Id@@ 
=@@ 
$num@@ 
,@@ 
NameAA 
=AA 
$strAA "
}BB 
,BB 
newCC 

IngredientCC 
{DD 
IdEE 
=EE 
$numEE 
,EE 
NameFF 
=FF 
$strFF !
}GG 
,GG 
newHH 

IngredientHH 
{II 
IdJJ 
=JJ 
$numJJ 
,JJ 
NameKK 
=KK 
$strKK )
}LL 
,LL 
newMM 

IngredientMM 
{NN 
IdOO 
=OO 
$numOO 
,OO 
NamePP 
=PP 
$strPP %
}QQ 
)RR 
;RR 
modelBuilderTT 
.TT 
EntityTT 
<TT  
DishIngredientTT  .
>TT. /
(TT/ 0
)TT0 1
.TT1 2
HasDataTT2 9
(TT9 :
newUU 
DishIngredientUU "
{VV 
DishIdWW 
=WW 
$numWW 
,WW 
IngredientIdXX  
=XX! "
$numXX# $
}YY 
,YY 
newZZ 
DishIngredientZZ "
{[[ 
DishId\\ 
=\\ 
$num\\ 
,\\ 
IngredientId]]  
=]]! "
$num]]# $
}^^ 
,^^ 
new__ 
DishIngredient__ "
{`` 
DishIdaa 
=aa 
$numaa 
,aa 
IngredientIdbb  
=bb! "
$numbb# $
}cc 
,cc 
newdd 
DishIngredientdd "
{ee 
DishIdff 
=ff 
$numff 
,ff 
IngredientIdgg  
=gg! "
$numgg# $
}hh 
,hh 
newii 
DishIngredientii "
{jj 
DishIdkk 
=kk 
$numkk 
,kk 
IngredientIdll  
=ll! "
$numll# $
}mm 
,mm 
newnn 
DishIngredientnn "
{oo 
DishIdpp 
=pp 
$numpp 
,pp 
IngredientIdqq  
=qq! "
$numqq# $
}rr 
,rr 
newss 
DishIngredientss "
{tt 
DishIduu 
=uu 
$numuu 
,uu 
IngredientIdvv  
=vv! "
$numvv# $
}ww 
,ww 
newxx 
DishIngredientxx "
{yy 
DishIdzz 
=zz 
$numzz 
,zz 
IngredientId{{  
={{! "
$num{{# $
}|| 
,|| 
new}} 
DishIngredient}} "
{~~ 
DishId 
= 
$num 
, 
IngredientId
ÄÄ  
=
ÄÄ! "
$num
ÄÄ# $
}
ÅÅ 
,
ÅÅ 
new
ÇÇ 
DishIngredient
ÇÇ "
{
ÉÉ 
DishId
ÑÑ 
=
ÑÑ 
$num
ÑÑ 
,
ÑÑ 
IngredientId
ÖÖ  
=
ÖÖ! "
$num
ÖÖ# $
}
ÜÜ 
,
ÜÜ 
new
áá 
DishIngredient
áá "
{
àà 
DishId
ââ 
=
ââ 
$num
ââ 
,
ââ 
IngredientId
ää  
=
ää! "
$num
ää# $
}
ãã 
)
åå 
;
åå 
base
éé 
.
éé 
OnModelCreating
éé  
(
éé  !
modelBuilder
éé! -
)
éé- .
;
éé. /
}
èè 	
public
êê 
DbSet
êê 
<
êê 
Dish
êê 
>
êê 
Dishes
êê !
{
êê" #
get
êê$ '
;
êê' (
set
êê) ,
;
êê, -
}
êê. /
public
ëë 
DbSet
ëë 
<
ëë 

Ingredient
ëë 
>
ëë  
Ingredients
ëë! ,
{
ëë- .
get
ëë/ 2
;
ëë2 3
set
ëë4 7
;
ëë7 8
}
ëë9 :
public
íí 
DbSet
íí 
<
íí 
DishIngredient
íí #
>
íí# $
DishIngredients
íí% 4
{
íí5 6
get
íí7 :
;
íí: ;
set
íí< ?
;
íí? @
}
ííA B
public
ìì 
DbSet
ìì 
<
ìì 
CartItem
ìì 
>
ìì 
	CartItems
ìì (
{
ìì) *
get
ìì+ .
;
ìì. /
set
ìì0 3
;
ìì3 4
}
ìì5 6
public
îî 
DbSet
îî 
<
îî 
Order
îî 
>
îî 
Orders
îî "
{
îî# $
get
îî% (
;
îî( )
set
îî* -
;
îî- .
}
îî/ 0
public
ïï 
DbSet
ïï 
<
ïï 
	OrderItem
ïï 
>
ïï 

OrderItems
ïï  *
{
ïï+ ,
get
ïï- 0
;
ïï0 1
set
ïï2 5
;
ïï5 6
}
ïï7 8
public
ññ 
DbSet
ññ 
<
ññ 
Account
ññ 
>
ññ 
Accounts
ññ &
{
ññ' (
get
ññ) ,
;
ññ, -
set
ññ. 1
;
ññ1 2
}
ññ3 4
public
óó 
DbSet
óó 
<
óó 
Voucher
óó 
>
óó 
Vouchers
óó &
{
óó' (
get
óó) ,
;
óó, -
set
óó. 1
;
óó1 2
}
óó3 4
}
òò 
}ôô óx
_C:\Users\Norial\Documents\GitHub\food-ordering-system\FoodProject\Controllers\MenuController.cs
	namespace 	
FoodProject
 
. 
Controllers !
{ 
public 

class 
MenuController 
:  !

Controller" ,
{		 
private

 
readonly

 
MenuContext

 $
_context

% -
;

- .
public 
MenuController 
( 
MenuContext )
context* 1
)1 2
{ 	
_context 
= 
context 
; 
} 	
[ 	
	Authorize	 
] 
public 
IActionResult 
AddDish $
($ %
)% &
{ 	
return 
View 
( 
) 
; 
} 	
[ 	
HttpPost	 
] 
[ 	
	Authorize	 
] 
public 
IActionResult 
AddDish $
($ %
Dish% )
dish* .
). /
{ 	
if 
( 

ModelState 
. 
IsValid "
)" #
{ 
_context 
. 
Dishes 
.  
Add  #
(# $
dish$ (
)( )
;) *
_context 
. 
SaveChanges $
($ %
)% &
;& '
return 
RedirectToAction '
(' (
$str( /
)/ 0
;0 1
} 
return 
View 
( 
dish 
) 
; 
}   	
public!! 
async!! 
Task!! 
<!! 
IActionResult!! '
>!!' (
Index!!) .
(!!. /
string!!/ 5
searchString!!6 B
,!!B C
string!!D J
category!!K S
=!!T U
$str!!V [
)!![ \
{"" 	
var## 
dishes## 
=## 
_context## !
.##! "
Dishes##" (
.##( )
AsQueryable##) 4
(##4 5
)##5 6
;##6 7
if%% 
(%% 
!%% 
string%% 
.%% 
IsNullOrEmpty%% %
(%%% &
category%%& .
)%%. /
&&%%0 2
category%%3 ;
!=%%< >
$str%%? D
)%%D E
{&& 
dishes'' 
='' 
dishes'' 
.''  
Where''  %
(''% &
d''& '
=>''( *
d''+ ,
.'', -
Category''- 5
==''6 8
category''9 A
)''A B
;''B C
}(( 
if** 
(** 
!** 
string** 
.** 
IsNullOrEmpty** %
(**% &
searchString**& 2
)**2 3
)**3 4
{++ 
dishes,, 
=,, 
dishes,, 
.,,  
Where,,  %
(,,% &
d,,& '
=>,,( *
d,,+ ,
.,,, -
Name,,- 1
.,,1 2
Contains,,2 :
(,,: ;
searchString,,; G
),,G H
),,H I
;,,I J
}-- 
ViewBag// 
.// 
SelectedCategory// $
=//% &
category//' /
;/// 0
ViewBag00 
.00 
SearchString00  
=00! "
searchString00# /
;00/ 0
return22 
View22 
(22 
await22 
dishes22 $
.22$ %
ToListAsync22% 0
(220 1
)221 2
)222 3
;223 4
}33 	
public66 
async66 
Task66 
<66 
IActionResult66 '
>66' (
Details66) 0
(660 1
int661 4
?664 5
id666 8
)668 9
{77 	
var88 
dish88 
=88 
await88 
_context88 %
.88% &
Dishes88& ,
.99 
Include99 
(99 
di99 
=>99 
di99 !
.99! "
DishIngredients99" 1
)991 2
.:: 
ThenInclude:: 
(:: 
i:: 
=>:: !
i::" #
.::# $

Ingredient::$ .
)::. /
.;; 
FirstOrDefaultAsync;; $
(;;$ %
x;;% &
=>;;' )
x;;* +
.;;+ ,
Id;;, .
==;;/ 1
id;;2 4
);;4 5
;;;5 6
if<< 
(<< 
dish<< 
==<< 
null<< 
)<< 
{== 
return>> 
NotFound>> 
(>>  
)>>  !
;>>! "
}?? 
return@@ 
View@@ 
(@@ 
dish@@ 
)@@ 
;@@ 
}AA 	
publicBB 
IActionResultBB 
EditBB !
(BB! "
intBB" %
idBB& (
)BB( )
{CC 	
varDD 
dishDD 
=DD 
_contextDD 
.DD  
DishesDD  &
.EE  
IncludeEE  '
(EE' (
dEE( )
=>EE* ,
dEE- .
.EE. /
DishIngredientsEE/ >
)EE> ?
.FF  
ThenIncludeFF  +
(FF+ ,
diFF, .
=>FF/ 1
diFF2 4
.FF4 5

IngredientFF5 ?
)FF? @
.GG  
FirstOrDefaultGG  .
(GG. /
dGG/ 0
=>GG1 3
dGG4 5
.GG5 6
IdGG6 8
==GG9 ;
idGG< >
)GG> ?
;GG? @
ifII 
(II 
dishII 
==II 
nullII 
)II 
returnII $
NotFoundII% -
(II- .
)II. /
;II/ 0
varKK 
ingredientsKK 
=KK 
_contextKK &
.KK& '
IngredientsKK' 2
.KK2 3
ToListKK3 9
(KK9 :
)KK: ;
;KK; <
varMM 
	viewModelMM 
=MM 
newMM 
DishEditViewModelMM  1
{NN 
DishOO 
=OO 
dishOO 
,OO 
AllIngredientsPP 
=PP  
ingredientsPP! ,
??PP- /
newPP0 3
ListPP4 8
<PP8 9

IngredientPP9 C
>PPC D
(PPD E
)PPE F
,PPF G!
SelectedIngredientIdsQQ %
=QQ& '
dishQQ( ,
.QQ, -
DishIngredientsQQ- <
?QQ< =
.QQ= >
SelectQQ> D
(QQD E
diQQE G
=>QQH J
diQQK M
.QQM N
IngredientIdQQN Z
)QQZ [
.QQ[ \
ToListQQ\ b
(QQb c
)QQc d
??QQe g
newQQh k
ListQQl p
<QQp q
intQQq t
>QQt u
(QQu v
)QQv w
}RR 
;RR 
returnTT 
ViewTT 
(TT 
	viewModelTT !
)TT! "
;TT" #
}UU 	
[WW 	
HttpPostWW	 
]WW 
publicXX 
IActionResultXX 
EditXX !
(XX! "
DishEditViewModelXX" 3
modelXX4 9
)XX9 :
{YY 	
ifZZ 
(ZZ 
!ZZ 

ModelStateZZ 
.ZZ 
IsValidZZ #
)ZZ# $
returnZZ% +
ViewZZ, 0
(ZZ0 1
modelZZ1 6
)ZZ6 7
;ZZ7 8
var\\ 
dish\\ 
=\\ 
_context\\ 
.\\  
Dishes\\  &
.\\& '
Include\\' .
(\\. /
d\\/ 0
=>\\1 3
d\\4 5
.\\5 6
DishIngredients\\6 E
)\\E F
.]]& '
FirstOrDefault]]' 5
(]]5 6
d]]6 7
=>]]8 :
d]]; <
.]]< =
Id]]= ?
==]]@ B
model]]C H
.]]H I
Dish]]I M
.]]M N
Id]]N P
)]]P Q
;]]Q R
if^^ 
(^^ 
dish^^ 
==^^ 
null^^ 
)^^ 
return^^ $
NotFound^^% -
(^^- .
)^^. /
;^^/ 0
dish`` 
.`` 
Name`` 
=`` 
model`` 
.`` 
Dish`` "
.``" #
Name``# '
;``' (
dishaa 
.aa 
Descriptionaa 
=aa 
modelaa $
.aa$ %
Dishaa% )
.aa) *
Descriptionaa* 5
;aa5 6
dishbb 
.bb 
ImageUrlbb 
=bb 
modelbb !
.bb! "
Dishbb" &
.bb& '
ImageUrlbb' /
;bb/ 0
dishcc 
.cc 
Pricecc 
=cc 
modelcc 
.cc 
Dishcc #
.cc# $
Pricecc$ )
;cc) *
dishee 
.ee 
DishIngredientsee  
.ee  !
Clearee! &
(ee& '
)ee' (
;ee( )
ifff 
(ff 
modelff 
.ff !
SelectedIngredientIdsff +
!=ff, .
nullff/ 3
)ff3 4
{gg 
foreachhh 
(hh 
varhh 
ingredientIdhh )
inhh* ,
modelhh- 2
.hh2 3!
SelectedIngredientIdshh3 H
)hhH I
{ii 
dishjj 
.jj 
DishIngredientsjj (
.jj( )
Addjj) ,
(jj, -
newjj- 0
DishIngredientjj1 ?
{kk 
DishIdll 
=ll  
dishll! %
.ll% &
Idll& (
,ll( )
IngredientIdmm $
=mm% &
ingredientIdmm' 3
}nn 
)nn 
;nn 
}oo 
}pp 
_contextrr 
.rr 
SaveChangesrr  
(rr  !
)rr! "
;rr" #
returnss 
RedirectToActionss #
(ss# $
$strss$ -
,ss- .
$strss/ 5
,ss5 6
newss7 :
{ss; <
idss= ?
=ss@ A
dishssB F
.ssF G
IdssG I
}ssJ K
)ssK L
;ssL M
}tt 	
[vv 	
HttpPostvv	 
]vv 
publicww 
IActionResultww 
Deleteww #
(ww# $
intww$ '
idww( *
)ww* +
{xx 	
varyy 
dishyy 
=yy 
_contextyy 
.yy  
Dishesyy  &
.yy& '
Findyy' +
(yy+ ,
idyy, .
)yy. /
;yy/ 0
ifzz 
(zz 
dishzz 
==zz 
nullzz 
)zz 
returnzz $
NotFoundzz% -
(zz- .
)zz. /
;zz/ 0
_context|| 
.|| 
Dishes|| 
.|| 
Remove|| "
(||" #
dish||# '
)||' (
;||( )
_context}} 
.}} 
SaveChanges}}  
(}}  !
)}}! "
;}}" #
return~~ 
RedirectToAction~~ #
(~~# $
$str~~$ +
)~~+ ,
;~~, -
} 	
[
ÄÄ 	
	Authorize
ÄÄ	 
(
ÄÄ 
Roles
ÄÄ 
=
ÄÄ 
$str
ÄÄ "
)
ÄÄ" #
]
ÄÄ# $
public
ÅÅ 
async
ÅÅ 
Task
ÅÅ 
<
ÅÅ 
IActionResult
ÅÅ '
>
ÅÅ' (

AddVoucher
ÅÅ) 3
(
ÅÅ3 4
)
ÅÅ4 5
{
ÇÇ 	
var
ÉÉ 
	viewModel
ÉÉ 
=
ÉÉ 
new
ÉÉ 
Tuple
ÉÉ  %
<
ÉÉ% &
Voucher
ÉÉ& -
,
ÉÉ- .
List
ÉÉ/ 3
<
ÉÉ3 4
Voucher
ÉÉ4 ;
>
ÉÉ; <
>
ÉÉ< =
(
ÉÉ= >
new
ÑÑ 
Voucher
ÑÑ 
(
ÑÑ 
)
ÑÑ 
,
ÑÑ 
await
ÖÖ 
_context
ÖÖ 
.
ÖÖ 
Vouchers
ÖÖ '
.
ÖÖ' (
ToListAsync
ÖÖ( 3
(
ÖÖ3 4
)
ÖÖ4 5
)
ÜÜ 
;
ÜÜ 
return
áá 
View
áá 
(
áá 
	viewModel
áá !
)
áá! "
;
áá" #
}
àà 	
[
ää 	
HttpPost
ää	 
]
ää 
[
ãã 	
	Authorize
ãã	 
(
ãã 
Roles
ãã 
=
ãã 
$str
ãã "
)
ãã" #
]
ãã# $
public
åå 
async
åå 
Task
åå 
<
åå 
IActionResult
åå '
>
åå' (

AddVoucher
åå) 3
(
åå3 4
Voucher
åå4 ;
voucher
åå< C
)
ååC D
{
çç 	
if
éé 
(
éé 

ModelState
éé 
.
éé 
IsValid
éé "
)
éé" #
{
èè 
_context
êê 
.
êê 
Vouchers
êê !
.
êê! "
Add
êê" %
(
êê% &
voucher
êê& -
)
êê- .
;
êê. /
await
ëë 
_context
ëë 
.
ëë 
SaveChangesAsync
ëë /
(
ëë/ 0
)
ëë0 1
;
ëë1 2
return
íí 
RedirectToAction
íí '
(
íí' (
$str
íí( 4
)
íí4 5
;
íí5 6
}
ìì 
var
ïï 
vouchers
ïï 
=
ïï 
await
ïï  
_context
ïï! )
.
ïï) *
Vouchers
ïï* 2
.
ïï2 3
ToListAsync
ïï3 >
(
ïï> ?
)
ïï? @
;
ïï@ A
return
ññ 
View
ññ 
(
ññ 
new
ññ 
Tuple
ññ !
<
ññ! "
Voucher
ññ" )
,
ññ) *
List
ññ+ /
<
ññ/ 0
Voucher
ññ0 7
>
ññ7 8
>
ññ8 9
(
ññ9 :
voucher
ññ: A
,
ññA B
vouchers
ññC K
)
ññK L
)
ññL M
;
ññM N
}
óó 	
[
ôô 	
HttpPost
ôô	 
]
ôô 
[
öö 	
	Authorize
öö	 
(
öö 
Roles
öö 
=
öö 
$str
öö "
)
öö" #
]
öö# $
public
õõ 
async
õõ 
Task
õõ 
<
õõ 
IActionResult
õõ '
>
õõ' (
RemoveVoucher
õõ) 6
(
õõ6 7
int
õõ7 :
id
õõ; =
)
õõ= >
{
úú 	
var
ùù 
voucher
ùù 
=
ùù 
await
ùù 
_context
ùù  (
.
ùù( )
Vouchers
ùù) 1
.
ùù1 2
	FindAsync
ùù2 ;
(
ùù; <
id
ùù< >
)
ùù> ?
;
ùù? @
if
ûû 
(
ûû 
voucher
ûû 
!=
ûû 
null
ûû 
)
ûû  
{
üü 
_context
†† 
.
†† 
Vouchers
†† !
.
††! "
Remove
††" (
(
††( )
voucher
††) 0
)
††0 1
;
††1 2
await
°° 
_context
°° 
.
°° 
SaveChangesAsync
°° /
(
°°/ 0
)
°°0 1
;
°°1 2
}
¢¢ 
return
§§ 
RedirectToAction
§§ #
(
§§# $
$str
§§$ 0
)
§§0 1
;
§§1 2
}
•• 	
}
ßß 
}®® ⁄
eC:\Users\Norial\Documents\GitHub\food-ordering-system\FoodProject\Controllers\IngredientController.cs
public 
class  
IngredientController !
:" #

Controller$ .
{ 
private 
readonly 
MenuContext  
_context! )
;) *
public		 
 
IngredientController		 
(		  
MenuContext		  +
context		, 3
)		3 4
{

 
_context 
= 
context 
; 
} 
public 

IActionResult 
AddIngredient &
(& '
)' (
{ 
var 
ingredients 
= 
_context "
." #
Ingredients# .
.. /
ToList/ 5
(5 6
)6 7
;7 8
return 
View 
( 
ingredients 
)  
;  !
} 
[ 
HttpPost 
] 
public 

IActionResult 
AddIngredient &
(& '

Ingredient' 1

ingredient2 <
)< =
{ 
if 

( 

ModelState 
. 
IsValid 
) 
{ 	
_context 
. 
Ingredients  
.  !
Add! $
($ %

ingredient% /
)/ 0
;0 1
_context 
. 
SaveChanges  
(  !
)! "
;" #
return 
RedirectToAction #
(# $
$str$ 3
)3 4
;4 5
} 	
var 
ingredients 
= 
_context "
." #
Ingredients# .
.. /
ToList/ 5
(5 6
)6 7
;7 8
return 
View 
( 
ingredients 
)  
;  !
}   
["" 

HttpDelete"" 
]"" 
public## 

IActionResult## 
DeleteIngredient## )
(##) *
int##* -
id##. 0
)##0 1
{$$ 
var%% 

ingredient%% 
=%% 
_context%% !
.%%! "
Ingredients%%" -
.%%- .
Find%%. 2
(%%2 3
id%%3 5
)%%5 6
;%%6 7
if&& 

(&& 

ingredient&& 
==&& 
null&& 
)&& 
{'' 	
return(( 
Json(( 
((( 
new(( 
{(( 
success(( %
=((& '
false((( -
}((. /
)((/ 0
;((0 1
})) 	
_context++ 
.++ 
Ingredients++ 
.++ 
Remove++ #
(++# $

ingredient++$ .
)++. /
;++/ 0
_context,, 
.,, 
SaveChanges,, 
(,, 
),, 
;,, 
return.. 
Json.. 
(.. 
new.. 
{.. 
success.. !
=.." #
true..$ (
}..) *
)..* +
;..+ ,
}// 
}00 ú
_C:\Users\Norial\Documents\GitHub\food-ordering-system\FoodProject\Controllers\HomeController.cs
	namespace 	
FoodProject
 
. 
Controllers !
{		 
public

 

class

 
HomeController

 
:

  !

Controller

" ,
{ 
private 
readonly 
ILogger  
<  !
HomeController! /
>/ 0
_logger1 8
;8 9
private 
readonly 
MenuContext $
_context% -
;- .
public 
HomeController 
( 
ILogger %
<% &
HomeController& 4
>4 5
logger6 <
,< =
MenuContext> I
contextJ Q
)Q R
{ 	
_logger 
= 
logger 
; 
_context 
= 
context 
; 
} 	
public 
IActionResult 
Index "
(" #
)# $
{ 	
var 
randomDishes 
= 
_context '
.' (
Dishes( .
. 
OrderBy 
( 
d 
=> 
Guid "
." #
NewGuid# *
(* +
)+ ,
), -
. 
Take 
( 
$num 
) 
. 
ToList 
( 
) 
; 
var 

totalUsers 
= 
_context %
.% &
Accounts& .
.. /
Count/ 4
(4 5
a5 6
=>7 9
a: ;
.; <
Role< @
==A C
$strD J
)J K
;K L
var 
	viewModel 
= 
new 
HomePageViewModel  1
{ 
Dishes   
=   
randomDishes   %
,  % &

TotalUsers!! 
=!! 

totalUsers!! '
}"" 
;"" 
return$$ 
View$$ 
($$ 
	viewModel$$ !
)$$! "
;$$" #
}%% 	
public'' 
IActionResult'' 
Privacy'' $
(''$ %
)''% &
{(( 	
return)) 
View)) 
()) 
))) 
;)) 
}** 	
[,, 	
ResponseCache,,	 
(,, 
Duration,, 
=,,  !
$num,," #
,,,# $
Location,,% -
=,,. /!
ResponseCacheLocation,,0 E
.,,E F
None,,F J
,,,J K
NoStore,,L S
=,,T U
true,,V Z
),,Z [
],,[ \
public-- 
IActionResult-- 
Error-- "
(--" #
)--# $
{.. 	
return// 
View// 
(// 
new// 
ErrorViewModel// *
{//+ ,
	RequestId//- 6
=//7 8
Activity//9 A
.//A B
Current//B I
?//I J
.//J K
Id//K M
??//N P
HttpContext//Q \
.//\ ]
TraceIdentifier//] l
}//m n
)//n o
;//o p
}00 	
}11 
}22 ß
cC:\Users\Norial\Documents\GitHub\food-ordering-system\FoodProject\Controllers\CheckoutController.cs
	namespace		 	
FoodProject		
 
.		 
Controllers		 !
{

 
public 

class 
CheckoutController #
:$ %

Controller& 0
{ 
private 
readonly 
MenuContext $
_context% -
;- .
public 
CheckoutController !
(! "
MenuContext" -
context. 5
)5 6
{ 	
_context 
= 
context 
; 
} 	
public 
async 
Task 
< 
IActionResult '
>' (
Index) .
(. /
)/ 0
{ 	
var 
	cartItems 
= 
await !
_context" *
.* +
	CartItems+ 4
. 
Include 
( 
c 
=> 
c 
.  
Dish  $
)$ %
. 
ToListAsync 
( 
) 
; 
var 

totalPrice 
= 
	cartItems &
.& '
Sum' *
(* +
item+ /
=>0 2
item3 7
.7 8
Quantity8 @
*A B
itemC G
.G H
DishH L
.L M
PriceM R
)R S
;S T
ViewBag 
. 

TotalPrice 
=  

totalPrice! +
;+ ,
return 
View 
( 
) 
; 
}   	
[## 	
	Authorize##	 
]## 
public$$ 
async$$ 
Task$$ 
<$$ 
IActionResult$$ '
>$$' (
MyOrders$$) 1
($$1 2
string$$2 8
status$$9 ?
=$$@ A
$str$$B G
)$$G H
{%% 	
var&& 
	accountId&& 
=&& 
int&& 
.&&  
Parse&&  %
(&&% &
User&&& *
.&&* +
	FindFirst&&+ 4
(&&4 5
$str&&5 @
)&&@ A
?&&A B
.&&B C
Value&&C H
)&&H I
;&&I J
var(( 
ordersQuery(( 
=(( 
_context(( &
.((& '
Orders((' -
.)) 
Include)) 
()) 
o)) 
=>)) 
o)) 
.))  

OrderItems))  *
)))* +
.** 
ThenInclude**  
(**  !
oi**! #
=>**$ &
oi**' )
.**) *
Dish*** .
)**. /
.++ 
Where++ 
(++ 
o++ 
=>++ 
o++ 
.++ 
	AccountId++ '
==++( *
	accountId+++ 4
)++4 5
.,, 
AsQueryable,, 
(,, 
),, 
;,, 
if.. 
(.. 
!.. 
string.. 
... 
IsNullOrEmpty.. %
(..% &
status..& ,
).., -
&&... 0
status..1 7
!=..8 :
$str..; @
)..@ A
{// 
ordersQuery00 
=00 
ordersQuery00 )
.00) *
Where00* /
(00/ 0
o000 1
=>002 4
o005 6
.006 7
Status007 =
==00> @
status00A G
)00G H
;00H I
}11 
ViewBag33 
.33 
SelectedStatus33 "
=33# $
status33% +
;33+ ,
return44 
View44 
(44 
await44 
ordersQuery44 )
.44) *
ToListAsync44* 5
(445 6
)446 7
)447 8
;448 9
}55 	
[77 	
	Authorize77	 
(77 
Roles77 
=77 
$str77 "
)77" #
]77# $
public88 
async88 
Task88 
<88 
IActionResult88 '
>88' (
Orders88) /
(88/ 0
string880 6
status887 =
=88> ?
$str88@ E
)88E F
{99 	
var:: 
ordersQuery:: 
=:: 
_context:: &
.::& '
Orders::' -
.;; 
Include;; 
(;; 
o;; 
=>;; 
o;; 
.;;  
Account;;  '
);;' (
.<< 
Include<< 
(<< 
o<< 
=><< 
o<< 
.<<  

OrderItems<<  *
)<<* +
.== 
ThenInclude==  
(==  !
oi==! #
=>==$ &
oi==' )
.==) *
Dish==* .
)==. /
.>> 
AsQueryable>> 
(>> 
)>> 
;>> 
if@@ 
(@@ 
!@@ 
string@@ 
.@@ 
IsNullOrEmpty@@ %
(@@% &
status@@& ,
)@@, -
&&@@. 0
status@@1 7
!=@@8 :
$str@@; @
)@@@ A
{AA 
ordersQueryBB 
=BB 
ordersQueryBB )
.BB) *
WhereBB* /
(BB/ 0
oBB0 1
=>BB2 4
oBB5 6
.BB6 7
StatusBB7 =
==BB> @
statusBBA G
)BBG H
;BBH I
}CC 
ViewBagEE 
.EE 
SelectedStatusEE "
=EE# $
statusEE% +
;EE+ ,
returnFF 
ViewFF 
(FF 
awaitFF 
ordersQueryFF )
.FF) *
ToListAsyncFF* 5
(FF5 6
)FF6 7
)FF7 8
;FF8 9
}GG 	
publicJJ 
asyncJJ 
TaskJJ 
<JJ 
IActionResultJJ '
>JJ' (
OrderConfirmationJJ) :
(JJ: ;
intJJ; >
orderIdJJ? F
)JJF G
{KK 	
varLL 
	accountIdLL 
=LL 
intLL 
.LL  
ParseLL  %
(LL% &
UserLL& *
.LL* +
	FindFirstLL+ 4
(LL4 5
$strLL5 @
)LL@ A
?LLA B
.LLB C
ValueLLC H
)LLH I
;LLI J
varNN 
orderNN 
=NN 
awaitNN 
_contextNN &
.NN& '
OrdersNN' -
.OO 
IncludeOO 
(OO 
oOO 
=>OO 
oOO 
.OO  

OrderItemsOO  *
)OO* +
.PP 
ThenIncludePP 
(PP 
oiPP 
=>PP  "
oiPP# %
.PP% &
DishPP& *
)PP* +
.QQ 
FirstOrDefaultAsyncQQ $
(QQ$ %
oQQ% &
=>QQ' )
oQQ* +
.QQ+ ,
IdQQ, .
==QQ/ 1
orderIdQQ2 9
&&QQ: <
oQQ= >
.QQ> ?
	AccountIdQQ? H
==QQI K
	accountIdQQL U
)QQU V
;QQV W
ifSS 
(SS 
orderSS 
==SS 
nullSS 
)SS 
{TT 
returnUU 
NotFoundUU 
(UU  
)UU  !
;UU! "
}VV 
returnXX 
ViewXX 
(XX 
orderXX 
)XX 
;XX 
}YY 	
[]] 	
HttpPost]]	 
]]] 
[^^ 	
	Authorize^^	 
(^^ 
Roles^^ 
=^^ 
$str^^ "
)^^" #
]^^# $
public__ 
async__ 
Task__ 
<__ 
IActionResult__ '
>__' (
UpdateOrderStatus__) :
(__: ;
int__; >
orderId__? F
,__F G
string__H N
	newStatus__O X
)__X Y
{`` 	
varaa 
orderaa 
=aa 
awaitaa 
_contextaa &
.aa& '
Ordersaa' -
.aa- .
	FindAsyncaa. 7
(aa7 8
orderIdaa8 ?
)aa? @
;aa@ A
ifbb 
(bb 
orderbb 
==bb 
nullbb 
)bb 
returnbb %
NotFoundbb& .
(bb. /
)bb/ 0
;bb0 1
orderdd 
.dd 
Statusdd 
=dd 
	newStatusdd $
;dd$ %
awaitee 
_contextee 
.ee 
SaveChangesAsyncee +
(ee+ ,
)ee, -
;ee- .
returngg 
RedirectToActiongg #
(gg# $
$strgg$ ,
)gg, -
;gg- .
}hh 	
[jj 	
HttpPostjj	 
]jj 
[kk 	
	Authorizekk	 
(kk 
Roleskk 
=kk 
$strkk !
)kk! "
]kk" #
publicll 
asyncll 
Taskll 
<ll 
IActionResultll '
>ll' ( 
ConfirmOrderReceivedll) =
(ll= >
intll> A
orderIdllB I
)llI J
{mm 	
varnn 
	accountIdnn 
=nn 
intnn 
.nn  
Parsenn  %
(nn% &
Usernn& *
.nn* +
	FindFirstnn+ 4
(nn4 5
$strnn5 @
)nn@ A
?nnA B
.nnB C
ValuennC H
)nnH I
;nnI J
varoo 
orderoo 
=oo 
awaitoo 
_contextoo &
.oo& '
Ordersoo' -
.oo- .
FirstOrDefaultAsyncoo. A
(ooA B
oooB C
=>ooD F
oooG H
.ooH I
IdooI K
==ooL N
orderIdooO V
&&ooW Y
oooZ [
.oo[ \
	AccountIdoo\ e
==oof h
	accountIdooi r
)oor s
;oos t
ifqq 
(qq 
orderqq 
==qq 
nullqq 
||qq  
orderqq! &
.qq& '
Statusqq' -
!=qq. 0
$strqq1 =
)qq= >
{rr 
returnss 

BadRequestss !
(ss! "
$strss" U
)ssU V
;ssV W
}tt 
ordervv 
.vv 
Statusvv 
=vv 
$strvv %
;vv% &
awaitww 
_contextww 
.ww 
SaveChangesAsyncww +
(ww+ ,
)ww, -
;ww- .
returnyy 
RedirectToActionyy #
(yy# $
$stryy$ .
)yy. /
;yy/ 0
}zz 	
[|| 	
HttpPost||	 
]|| 
[}} 	
	Authorize}}	 
(}} 
Roles}} 
=}} 
$str}} !
)}}! "
]}}" #
public~~ 
async~~ 
Task~~ 
<~~ 
IActionResult~~ '
>~~' (
CancelOrder~~) 4
(~~4 5
int~~5 8
orderId~~9 @
)~~@ A
{ 	
var
ÄÄ 
	accountId
ÄÄ 
=
ÄÄ 
int
ÄÄ 
.
ÄÄ  
Parse
ÄÄ  %
(
ÄÄ% &
User
ÄÄ& *
.
ÄÄ* +
	FindFirst
ÄÄ+ 4
(
ÄÄ4 5
$str
ÄÄ5 @
)
ÄÄ@ A
?
ÄÄA B
.
ÄÄB C
Value
ÄÄC H
)
ÄÄH I
;
ÄÄI J
var
ÅÅ 
order
ÅÅ 
=
ÅÅ 
await
ÅÅ 
_context
ÅÅ &
.
ÅÅ& '
Orders
ÅÅ' -
.
ÅÅ- .!
FirstOrDefaultAsync
ÅÅ. A
(
ÅÅA B
o
ÅÅB C
=>
ÅÅD F
o
ÅÅG H
.
ÅÅH I
Id
ÅÅI K
==
ÅÅL N
orderId
ÅÅO V
&&
ÅÅW Y
o
ÅÅZ [
.
ÅÅ[ \
	AccountId
ÅÅ\ e
==
ÅÅf h
	accountId
ÅÅi r
)
ÅÅr s
;
ÅÅs t
if
ÉÉ 
(
ÉÉ 
order
ÉÉ 
==
ÉÉ 
null
ÉÉ 
||
ÉÉ  
order
ÉÉ! &
.
ÉÉ& '
Status
ÉÉ' -
!=
ÉÉ. 0
$str
ÉÉ1 :
)
ÉÉ: ;
{
ÑÑ 
return
ÖÖ 

BadRequest
ÖÖ !
(
ÖÖ! "
$str
ÖÖ" U
)
ÖÖU V
;
ÖÖV W
}
ÜÜ 
order
àà 
.
àà 
Status
àà 
=
àà 
$str
àà %
;
àà% &
await
ââ 
_context
ââ 
.
ââ 
SaveChangesAsync
ââ +
(
ââ+ ,
)
ââ, -
;
ââ- .
return
ãã 
RedirectToAction
ãã #
(
ãã# $
$str
ãã$ .
)
ãã. /
;
ãã/ 0
}
åå 	
[
çç 	
HttpPost
çç	 
]
çç 
public
éé 
async
éé 
Task
éé 
<
éé 
IActionResult
éé '
>
éé' (
ApplyVoucher
éé) 5
(
éé5 6
string
éé6 <
code
éé= A
)
ééA B
{
èè 	
var
êê 
	accountId
êê 
=
êê 
int
êê 
.
êê  
Parse
êê  %
(
êê% &
User
êê& *
.
êê* +
	FindFirst
êê+ 4
(
êê4 5
$str
êê5 @
)
êê@ A
?
êêA B
.
êêB C
Value
êêC H
)
êêH I
;
êêI J
var
ëë 
	cartItems
ëë 
=
ëë 
await
ëë !
_context
ëë" *
.
ëë* +
	CartItems
ëë+ 4
.
íí 
Include
íí 
(
íí 
c
íí 
=>
íí 
c
íí 
.
íí  
Dish
íí  $
)
íí$ %
.
ìì 
Where
ìì 
(
ìì 
c
ìì 
=>
ìì 
c
ìì 
.
ìì 
	AccountId
ìì '
==
ìì( *
	accountId
ìì+ 4
)
ìì4 5
.
îî 
ToListAsync
îî 
(
îî 
)
îî 
;
îî 
var
ññ 
total
ññ 
=
ññ 
	cartItems
ññ !
.
ññ! "
Sum
ññ" %
(
ññ% &
item
ññ& *
=>
ññ+ -
item
ññ. 2
.
ññ2 3
Quantity
ññ3 ;
*
ññ< =
item
ññ> B
.
ññB C
Dish
ññC G
.
ññG H
Price
ññH M
)
ññM N
;
ññN O
var
òò 
voucher
òò 
=
òò 
await
òò 
_context
òò  (
.
òò( )
Vouchers
òò) 1
.
òò1 2!
FirstOrDefaultAsync
òò2 E
(
òòE F
v
òòF G
=>
òòH J
v
òòK L
.
òòL M
Code
òòM Q
==
òòR T
code
òòU Y
)
òòY Z
;
òòZ [
if
ôô 
(
ôô 
voucher
ôô 
!=
ôô 
null
ôô 
)
ôô  
{
öö 
var
õõ 
discountAmount
õõ "
=
õõ# $
total
õõ% *
*
õõ+ ,
voucher
õõ- 4
.
õõ4 5
Discount
õõ5 =
/
õõ> ?
$num
õõ@ C
;
õõC D
var
úú 
discountedTotal
úú #
=
úú$ %
total
úú& +
-
úú, -
discountAmount
úú. <
;
úú< =
return
ûû 
Json
ûû 
(
ûû 
new
ûû 
{
ûû  !
success
ûû" )
=
ûû* +
true
ûû, 0
,
ûû0 1
discountedTotal
ûû2 A
=
ûûB C
discountedTotal
ûûD S
.
ûûS T
ToString
ûûT \
(
ûû\ ]
$str
ûû] a
)
ûûa b
,
ûûb c
code
ûûd h
=
ûûi j
voucher
ûûk r
.
ûûr s
Code
ûûs w
}
ûûx y
)
ûûy z
;
ûûz {
}
üü 
return
°° 
Json
°° 
(
°° 
new
°° 
{
°° 
success
°° %
=
°°& '
false
°°( -
,
°°- .
message
°°/ 6
=
°°7 8
$str
°°9 P
}
°°Q R
)
°°R S
;
°°S T
}
¢¢ 	
[
££ 	
HttpPost
££	 
]
££ 
[
§§ 	&
ValidateAntiForgeryToken
§§	 !
]
§§! "
public
•• 
async
•• 
Task
•• 
<
•• 
IActionResult
•• '
>
••' (

PlaceOrder
••) 3
(
••3 4
string
••4 :
name
••; ?
,
••? @
string
••A G
address
••H O
,
••O P
string
••Q W
payment
••X _
,
••_ `
string
••a g
usedVoucher
••h s
)
••s t
{
¶¶ 	
var
ßß 
	accountId
ßß 
=
ßß 
int
ßß 
.
ßß  
Parse
ßß  %
(
ßß% &
User
ßß& *
.
ßß* +
	FindFirst
ßß+ 4
(
ßß4 5
$str
ßß5 @
)
ßß@ A
?
ßßA B
.
ßßB C
Value
ßßC H
)
ßßH I
;
ßßI J
var
©© 
	cartItems
©© 
=
©© 
await
©© !
_context
©©" *
.
©©* +
	CartItems
©©+ 4
.
™™ 
Include
™™ 
(
™™ 
c
™™ 
=>
™™ 
c
™™ 
.
™™  
Dish
™™  $
)
™™$ %
.
´´ 
Where
´´ 
(
´´ 
c
´´ 
=>
´´ 
c
´´ 
.
´´ 
	AccountId
´´ '
==
´´( *
	accountId
´´+ 4
)
´´4 5
.
¨¨ 
ToListAsync
¨¨ 
(
¨¨ 
)
¨¨ 
;
¨¨ 
if
ÆÆ 
(
ÆÆ 
!
ÆÆ 
	cartItems
ÆÆ 
.
ÆÆ 
Any
ÆÆ 
(
ÆÆ 
)
ÆÆ  
)
ÆÆ  !
return
ØØ 
RedirectToAction
ØØ '
(
ØØ' (
$str
ØØ( /
,
ØØ/ 0
$str
ØØ1 7
)
ØØ7 8
;
ØØ8 9
var
±± 
total
±± 
=
±± 
	cartItems
±± !
.
±±! "
Sum
±±" %
(
±±% &
item
±±& *
=>
±±+ -
item
±±. 2
.
±±2 3
Quantity
±±3 ;
*
±±< =
item
±±> B
.
±±B C
Dish
±±C G
.
±±G H
Price
±±H M
)
±±M N
;
±±N O
string
≤≤ 
appliedVoucher
≤≤ !
=
≤≤" #
null
≤≤$ (
;
≤≤( )
if
¥¥ 
(
¥¥ 
!
¥¥ 
string
¥¥ 
.
¥¥ 
IsNullOrEmpty
¥¥ %
(
¥¥% &
usedVoucher
¥¥& 1
)
¥¥1 2
)
¥¥2 3
{
µµ 
var
∂∂ 
voucher
∂∂ 
=
∂∂ 
await
∂∂ #
_context
∂∂$ ,
.
∂∂, -
Vouchers
∂∂- 5
.
∂∂5 6!
FirstOrDefaultAsync
∂∂6 I
(
∂∂I J
v
∂∂J K
=>
∂∂L N
v
∂∂O P
.
∂∂P Q
Code
∂∂Q U
==
∂∂V X
usedVoucher
∂∂Y d
)
∂∂d e
;
∂∂e f
if
∑∑ 
(
∑∑ 
voucher
∑∑ 
!=
∑∑ 
null
∑∑ #
)
∑∑# $
{
∏∏ 
total
ππ 
-=
ππ 
total
ππ "
*
ππ# $
voucher
ππ% ,
.
ππ, -
Discount
ππ- 5
/
ππ6 7
$num
ππ8 ;
;
ππ; <
appliedVoucher
∫∫ "
=
∫∫# $
voucher
∫∫% ,
.
∫∫, -
Code
∫∫- 1
;
∫∫1 2
}
ªª 
}
ºº 
var
ææ 
order
ææ 
=
ææ 
new
ææ 
Order
ææ !
{
øø 
	AccountId
¿¿ 
=
¿¿ 
	accountId
¿¿ %
,
¿¿% &

TotalPrice
¡¡ 
=
¡¡ 
total
¡¡ "
,
¡¡" #
VoucherCode
¬¬ 
=
¬¬ 
appliedVoucher
¬¬ ,
}
√√ 
;
√√ 
foreach
≈≈ 
(
≈≈ 
var
≈≈ 
cartItem
≈≈ !
in
≈≈" $
	cartItems
≈≈% .
)
≈≈. /
{
∆∆ 
order
«« 
.
«« 

OrderItems
««  
.
««  !
Add
««! $
(
««$ %
new
««% (
	OrderItem
««) 2
{
»» 
DishId
…… 
=
…… 
cartItem
…… %
.
……% &
DishId
……& ,
,
……, -
Quantity
   
=
   
cartItem
   '
.
  ' (
Quantity
  ( 0
,
  0 1
Price
ÀÀ 
=
ÀÀ 
cartItem
ÀÀ $
.
ÀÀ$ %
Dish
ÀÀ% )
.
ÀÀ) *
Price
ÀÀ* /
}
ÃÃ 
)
ÃÃ 
;
ÃÃ 
}
ÕÕ 
_context
œœ 
.
œœ 
Orders
œœ 
.
œœ 
Add
œœ 
(
œœ  
order
œœ  %
)
œœ% &
;
œœ& '
await
–– 
_context
–– 
.
–– 
SaveChangesAsync
–– +
(
––+ ,
)
––, -
;
––- .
_context
““ 
.
““ 
	CartItems
““ 
.
““ 
RemoveRange
““ *
(
““* +
	cartItems
““+ 4
)
““4 5
;
““5 6
await
”” 
_context
”” 
.
”” 
SaveChangesAsync
”” +
(
””+ ,
)
””, -
;
””- .
return
’’ 
RedirectToAction
’’ #
(
’’# $
$str
’’$ 7
,
’’7 8
new
’’9 <
{
’’= >
orderId
’’? F
=
’’G H
order
’’I N
.
’’N O
Id
’’O Q
}
’’R S
)
’’S T
;
’’T U
}
÷÷ 	
}
ÿÿ 
}ŸŸ €G
_C:\Users\Norial\Documents\GitHub\food-ordering-system\FoodProject\Controllers\CartController.cs
	namespace

 	
FoodProject


 
.

 
Controllers

 !
{ 
[ 
	Authorize 
] 
public 

class 
CartController 
:  !

Controller" ,
{ 
private 
readonly 
MenuContext $
_context% -
;- .
public 
CartController 
( 
MenuContext )
context* 1
)1 2
{ 	
_context 
= 
context 
; 
} 	
public 
async 
Task 
< 
IActionResult '
>' (
Index) .
(. /
)/ 0
{ 	
if 
( 
! 
int 
. 
TryParse 
( 
User "
." #
	FindFirst# ,
(, -
$str- 8
)8 9
?9 :
.: ;
Value; @
,@ A
outB E
intF I
	accountIdJ S
)S T
)T U
{ 
return 
RedirectToAction '
(' (
$str( /
,/ 0
$str1 :
): ;
;; <
} 
var 
	cartItems 
= 
await !
_context" *
.* +
	CartItems+ 4
. 
Include 
( 
ci 
=> 
ci !
.! "
Dish" &
)& '
. 
Where 
( 
ci 
=> 
ci 
.  
	AccountId  )
==* ,
	accountId- 6
)6 7
.   
ToListAsync   
(   
)   
;   
ViewBag"" 
."" 

TotalPrice"" 
=""  
	cartItems""! *
.""* +
Sum""+ .
("". /
ci""/ 1
=>""2 4
ci""5 7
.""7 8
Dish""8 <
.""< =
Price""= B
*""C D
ci""E G
.""G H
Quantity""H P
)""P Q
;""Q R
return## 
View## 
(## 
	cartItems## !
)##! "
;##" #
}$$ 	
['' 	
HttpPost''	 
]'' 
[(( 	
	Authorize((	 
](( 
public)) 
async)) 
Task)) 
<)) 
IActionResult)) '
>))' (
	AddToCart))) 2
())2 3
int))3 6
dishId))7 =
,))= >
int))? B
quantity))C K
=))L M
$num))N O
)))O P
{** 	
if++ 
(++ 
!++ 
int++ 
.++ 
TryParse++ 
(++ 
User++ "
.++" #
	FindFirst++# ,
(++, -
$str++- 8
)++8 9
?++9 :
.++: ;
Value++; @
,++@ A
out++B E
int++F I
	accountId++J S
)++S T
)++T U
{,, 
return-- 
RedirectToAction-- '
(--' (
$str--( /
,--/ 0
$str--1 :
)--: ;
;--; <
}.. 
var00 
dish00 
=00 
await00 
_context00 %
.00% &
Dishes00& ,
.00, -
FirstOrDefaultAsync00- @
(00@ A
d00A B
=>00C E
d00F G
.00G H
Id00H J
==00K M
dishId00N T
)00T U
;00U V
if11 
(11 
dish11 
==11 
null11 
)11 
{22 
return33 
NotFound33 
(33  
)33  !
;33! "
}44 
var66 
cartItem66 
=66 
await66  
_context66! )
.66) *
	CartItems66* 3
.77 
FirstOrDefaultAsync77 $
(77$ %
ci77% '
=>77( *
ci77+ -
.77- .
DishId77. 4
==775 7
dishId778 >
&&77? A
ci77B D
.77D E
	AccountId77E N
==77O Q
	accountId77R [
)77[ \
;77\ ]
if99 
(99 
cartItem99 
==99 
null99  
)99  !
{:: 
cartItem;; 
=;; 
new;; 
CartItem;; '
{<< 
DishId== 
=== 
dishId== #
,==# $
	AccountId>> 
=>> 
	accountId>>  )
,>>) *
Quantity?? 
=?? 
quantity?? '
}@@ 
;@@ 
_contextAA 
.AA 
	CartItemsAA "
.AA" #
AddAA# &
(AA& '
cartItemAA' /
)AA/ 0
;AA0 1
}BB 
elseCC 
{DD 
cartItemEE 
.EE 
QuantityEE !
+=EE" $
quantityEE% -
;EE- .
}FF 
awaitHH 
_contextHH 
.HH 
SaveChangesAsyncHH +
(HH+ ,
)HH, -
;HH- .
returnII 
RedirectToActionII #
(II# $
$strII$ +
)II+ ,
;II, -
}JJ 	
[MM 	
HttpPostMM	 
]MM 
publicNN 
asyncNN 
TaskNN 
<NN 
IActionResultNN '
>NN' (
UpdateQuantityNN) 7
(NN7 8
intNN8 ;

cartItemIdNN< F
,NNF G
intNNH K
quantityNNL T
)NNT U
{OO 	
varPP 
	accountIdPP 
=PP 
intPP 
.PP  
ParsePP  %
(PP% &
UserPP& *
.PP* +
	FindFirstPP+ 4
(PP4 5
$strPP5 @
)PP@ A
?PPA B
.PPB C
ValuePPC H
)PPH I
;PPI J
varRR 
cartItemRR 
=RR 
awaitRR  
_contextRR! )
.RR) *
	CartItemsRR* 3
.SS 
FirstOrDefaultAsyncSS $
(SS$ %
ciSS% '
=>SS( *
ciSS+ -
.SS- .
IdSS. 0
==SS1 3

cartItemIdSS4 >
&&SS? A
ciSSB D
.SSD E
	AccountIdSSE N
==SSO Q
	accountIdSSR [
)SS[ \
;SS\ ]
ifUU 
(UU 
cartItemUU 
==UU 
nullUU  
)UU  !
{VV 
returnWW 
NotFoundWW 
(WW  
)WW  !
;WW! "
}XX 
ifZZ 
(ZZ 
quantityZZ 
<=ZZ 
$numZZ 
)ZZ 
{[[ 
_context\\ 
.\\ 
	CartItems\\ "
.\\" #
Remove\\# )
(\\) *
cartItem\\* 2
)\\2 3
;\\3 4
}]] 
else^^ 
{__ 
cartItem`` 
.`` 
Quantity`` !
=``" #
quantity``$ ,
;``, -
}aa 
awaitcc 
_contextcc 
.cc 
SaveChangesAsynccc +
(cc+ ,
)cc, -
;cc- .
returndd 
RedirectToActiondd #
(dd# $
$strdd$ +
)dd+ ,
;dd, -
}ee 	
[gg 	
HttpPostgg	 
]gg 
publichh 
asynchh 
Taskhh 
<hh 
IActionResulthh '
>hh' (

RemoveItemhh) 3
(hh3 4
inthh4 7

cartItemIdhh8 B
)hhB C
{ii 	
varjj 
	accountIdjj 
=jj 
intjj 
.jj  
Parsejj  %
(jj% &
Userjj& *
.jj* +
	FindFirstjj+ 4
(jj4 5
$strjj5 @
)jj@ A
?jjA B
.jjB C
ValuejjC H
)jjH I
;jjI J
varll 
cartItemll 
=ll 
awaitll  
_contextll! )
.ll) *
	CartItemsll* 3
.mm 
FirstOrDefaultAsyncmm $
(mm$ %
cimm% '
=>mm( *
cimm+ -
.mm- .
Idmm. 0
==mm1 3

cartItemIdmm4 >
&&mm? A
cimmB D
.mmD E
	AccountIdmmE N
==mmO Q
	accountIdmmR [
)mm[ \
;mm\ ]
ifoo 
(oo 
cartItemoo 
==oo 
nulloo  
)oo  !
{pp 
returnqq 
NotFoundqq 
(qq  
)qq  !
;qq! "
}rr 
_contexttt 
.tt 
	CartItemstt 
.tt 
Removett %
(tt% &
cartItemtt& .
)tt. /
;tt/ 0
awaituu 
_contextuu 
.uu 
SaveChangesAsyncuu +
(uu+ ,
)uu, -
;uu- .
returnvv 
RedirectToActionvv #
(vv# $
$strvv$ +
)vv+ ,
;vv, -
}ww 	
}xx 
}yy ‰E
bC:\Users\Norial\Documents\GitHub\food-ordering-system\FoodProject\Controllers\AccountController.cs
	namespace 	
FoodProject
 
. 
Controllers !
{ 
public 

class 
AccountController "
:# $

Controller% /
{ 
private 
readonly 
MenuContext $
_context% -
;- .
public 
AccountController  
(  !
MenuContext! ,
context- 4
)4 5
{ 	
_context 
= 
context 
; 
} 	
public 
IActionResult 
Register %
(% &
)& '
{ 	
return 
View 
( 
) 
; 
} 	
[ 	
HttpPost	 
] 
public 
IActionResult 
Register %
(% &
Account& -
account. 5
)5 6
{ 	
try 
{   
account!! 
.!! 
Role!! 
=!! 
$str!! %
;!!% &
account"" 
."" 
Password""  
=""! "
HashPassword""# /
(""/ 0
account""0 7
.""7 8
Password""8 @
)""@ A
;""A B
_context$$ 
.$$ 
Accounts$$ !
.$$! "
Add$$" %
($$% &
account$$& -
)$$- .
;$$. /
try&& 
{'' 
var(( 
result(( 
=((  
_context((! )
.(() *
SaveChanges((* 5
(((5 6
)((6 7
;((7 8
return)) 
RedirectToAction)) +
())+ ,
$str)), 3
)))3 4
;))4 5
}** 
catch++ 
(++ 
	Exception++  
ex++! #
)++# $
{,, 
return-- 
Content-- "
(--" #
$"--# %
$str--% 5
{--5 6
ex--6 8
.--8 9
Message--9 @
}--@ A
$str--A J
{--J K
ex--K M
.--M N
InnerException--N \
?--\ ]
.--] ^
Message--^ e
}--e f
"--f g
)--g h
;--h i
}.. 
}// 
catch00 
(00 
	Exception00 
ex00 
)00  
{11 
return22 
Content22 
(22 
$"22 !
$str22! 0
{220 1
ex221 3
.223 4
Message224 ;
}22; <
"22< =
)22= >
;22> ?
}33 
}44 	
public66 
IActionResult66 
Login66 "
(66" #
)66# $
{77 	
return88 
View88 
(88 
)88 
;88 
}99 	
[:: 	
HttpPost::	 
]:: 
public;; 
async;; 
Task;; 
<;; 
IActionResult;; '
>;;' (
Login;;) .
(;;. /
Account;;/ 6
account;;7 >
,;;> ?
string;;@ F
?;;F G
	returnUrl;;H Q
=;;R S
null;;T X
);;X Y
{<< 	
try== 
{>> 
if?? 
(?? 
string?? 
.?? 
IsNullOrEmpty?? (
(??( )
account??) 0
.??0 1
Username??1 9
)??9 :
||??; =
string??> D
.??D E
IsNullOrEmpty??E R
(??R S
account??S Z
.??Z [
Password??[ c
)??c d
)??d e
{@@ 
returnAA 
ContentAA "
(AA" #
$strAA# O
)AAO P
;AAP Q
}BB 
stringDD 
hashedPasswordDD %
=DD& '
HashPasswordDD( 4
(DD4 5
accountDD5 <
.DD< =
PasswordDD= E
)DDE F
;DDF G
varEE 
userEE 
=EE 
awaitEE  
_contextEE! )
.EE) *
AccountsEE* 2
.EE2 3
FirstOrDefaultAsyncEE3 F
(EEF G
uEEG H
=>EEI K
uEEL M
.EEM N
UsernameEEN V
==EEW Y
accountEEZ a
.EEa b
UsernameEEb j
&&EEk m
uEEn o
.EEo p
PasswordEEp x
==EEy {
hashedPassword	EE| ä
)
EEä ã
;
EEã å
ifGG 
(GG 
userGG 
!=GG 
nullGG  
)GG  !
{HH 
varII 
claimsII 
=II  
newII! $
ListII% )
<II) *
ClaimII* /
>II/ 0
{JJ 
newKK 
ClaimKK 
(KK 

ClaimTypesKK $
.KK$ %
NameKK% )
,KK) *
userKK+ /
.KK/ 0
UsernameKK0 8
)KK8 9
,KK9 :
newLL 
ClaimLL 
(LL 

ClaimTypesLL $
.LL$ %
NameIdentifierLL% 3
,LL3 4
userLL5 9
.LL9 :
IdLL: <
.LL< =
ToStringLL= E
(LLE F
)LLF G
)LLG H
,LLH I
newMM 
ClaimMM 
(MM 
$strMM %
,MM% &
userMM' +
.MM+ ,
IdMM, .
.MM. /
ToStringMM/ 7
(MM7 8
)MM8 9
)MM9 :
,MM: ;
newNN 
ClaimNN 
(NN 

ClaimTypesNN $
.NN$ %
RoleNN% )
,NN) *
userNN+ /
.NN/ 0
RoleNN0 4
)NN4 5
}OO 
;OO 
varQQ 
claimsIdentityQQ &
=QQ' (
newQQ) ,
ClaimsIdentityQQ- ;
(QQ; <
claimsQQ< B
,QQB C(
CookieAuthenticationDefaultsQQD `
.QQ` a 
AuthenticationSchemeQQa u
)QQu v
;QQv w
varRR 
authPropertiesRR &
=RR' (
newRR) ,$
AuthenticationPropertiesRR- E
{SS 
IsPersistentTT $
=TT% &
trueTT' +
}UU 
;UU 
awaitWW 
HttpContextWW %
.WW% &
SignInAsyncWW& 1
(WW1 2(
CookieAuthenticationDefaultsWW2 N
.WWN O 
AuthenticationSchemeWWO c
,WWc d
newWWe h
ClaimsPrincipalWWi x
(WWx y
claimsIdentity	WWy á
)
WWá à
,
WWà â
authProperties
WWä ò
)
WWò ô
;
WWô ö
returnYY 
RedirectToActionYY +
(YY+ ,
$strYY, 3
,YY3 4
$strYY5 ;
)YY; <
;YY< =
}ZZ 
else[[ 
{\\ 
return]] 
Content]] "
(]]" #
$str]]# I
)]]I J
;]]J K
}^^ 
}__ 
catch`` 
(`` 
	Exception`` 
ex`` 
)``  
{aa 
returnbb 
Contentbb 
(bb 
$"bb !
$strbb! /
{bb/ 0
exbb0 2
.bb2 3
Messagebb3 :
}bb: ;
"bb; <
)bb< =
;bb= >
}cc 
}dd 	
publicgg 
asyncgg 
Taskgg 
<gg 
IActionResultgg '
>gg' (
Logoutgg) /
(gg/ 0
)gg0 1
{hh 	
awaitii 
HttpContextii 
.ii 
SignOutAsyncii *
(ii* +(
CookieAuthenticationDefaultsii+ G
.iiG H 
AuthenticationSchemeiiH \
)ii\ ]
;ii] ^
returnjj 
RedirectToActionjj #
(jj# $
$strjj$ +
,jj+ ,
$strjj- 3
)jj3 4
;jj4 5
}kk 	
privatemm 
stringmm 
HashPasswordmm #
(mm# $
stringmm$ *
passwordmm+ 3
)mm3 4
{nn 	
usingoo 
(oo 
varoo 
sha256oo 
=oo 
SHA256oo  &
.oo& '
Createoo' -
(oo- .
)oo. /
)oo/ 0
{pp 
varqq 
hashedBytesqq 
=qq  !
sha256qq" (
.qq( )
ComputeHashqq) 4
(qq4 5
Encodingqq5 =
.qq= >
UTF8qq> B
.qqB C
GetBytesqqC K
(qqK L
passwordqqL T
)qqT U
)qqU V
;qqV W
returnrr 
BitConverterrr #
.rr# $
ToStringrr$ ,
(rr, -
hashedBytesrr- 8
)rr8 9
.rr9 :
Replacerr: A
(rrA B
$strrrB E
,rrE F
$strrrG I
)rrI J
.rrJ K
ToLowerrrK R
(rrR S
)rrS T
;rrT U
}ss 
}tt 	
}uu 
}vv 